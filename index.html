<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>Grodowa Odyseja</title>
  <!-- Czcionki Å›redniowieczne -->
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body {
      font-family: 'MedievalSharp', cursive;
      background: url('tÅ‚o gry.png') center/cover fixed;
      color: #f4f1e6;
      overflow: hidden;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .screen { display: none; animation: fadeIn .4s; padding: 16px; max-width: 480px; margin: auto; min-height: 100vh; overflow-y: auto; }
    .active { display: block; }
    h1,h2,h3 { text-align: center; font-family: 'Uncial Antiqua', cursive; text-shadow: 2px 2px 4px rgba(0,0,0,.6); margin-bottom: 12px; }
    input[type=text] { width: 100%; padding: 10px; margin: 8px 0; border: none; border-radius: 6px; font-size: 16px; }
    .btn { width: 100%; padding: 12px; margin: 8px 0; font-size: 18px; border: none; border-radius: 8px; background: linear-gradient(to bottom,#c49e5b,#8b6237); color: #fff9e6; cursor: pointer; }
    .btn:disabled { opacity: .6; cursor: default; }
    .instruction-box, .final-box { background: rgba(0,0,0,.6); border: 2px solid #8d744a; border-radius: 8px; padding: 12px; margin: 12px 0; font-size: 14px; line-height: 1.4; }
    .instruction-box ol, .instruction-box ul { margin-left: 16px; }
    .roles { display: grid; grid-template-columns: repeat(auto-fit,minmax(80px,1fr)); gap: 12px; justify-items: center; }
    .role { background: rgba(0,0,0,.5); padding: 6px; border-radius: 12px; text-align: center; cursor: pointer; transition: transform .2s; }
    .role:hover { transform: translateY(-4px); }
    .role img { width: 80px; height: 80px; object-fit: cover; border-radius: 12px; border: 2px solid transparent; }
    .role.selected img { border-color: gold; box-shadow: 0 0 6px gold; }
    #videoOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,.9); display: none; align-items: center; justify-content: center; flex-direction: column; z-index: 1000; padding: 16px; }
    #videoOverlay video { width: 90%; max-width: 360px; border-radius: 12px; }
  </style>
</head>
<body>
  <div id="musicToggle">ğŸµ</div>
  <audio id="bgMusic" src="celtic-festival-307626.mp3" autoplay loop playsinline></audio>

  <!-- 1. Instrukcja gry -->
  <div id="page1" class="screen active">
    <h1>GRODOWA ODYSEJA</h1>
    <div class="instruction-box">
      <h3>Mechanika gry â€Dziedzictwoâ€</h3>
      <ol>
        <li>Wprowadzenie fabularne â€“ zapoznajcie siÄ™ z realiami Pomorza X wieku.</li>
        <li>Tworzenie druÅ¼yny â€“ wpiszcie nazwÄ™ druÅ¼yny.</li>
        <li>WybÃ³r postaci â€“ kaÅ¼da rola ma unikalne moÅ¼liwoÅ›ci.</li>
        <li>Zadania â€“ wykonajcie 4 z 6 zadaÅ„ gÅ‚Ã³wnych oraz 1 zadanie poboczne.</li>
        <li>Rada Grodu â€“ decyzja, ktÃ³ra zdecyduje o przyszÅ‚oÅ›ci grodu.</li>
      </ol>
    </div>
    <input id="teamName" type="text" placeholder="Nazwa druÅ¼yny">
    <button class="btn" id="to2">DALEJ</button>
  </div>

  <!-- 2. PeÅ‚na fabuÅ‚a -->
  <div id="page2" class="screen">
    <h2>PEÅNA FABUÅA</h2>
    <div class="instruction-box">
      <p>Rok 972. Sopockie Grodzisko pamiÄ™ta spokÃ³j ostatniego lata â€“ teraz jednak ziemia drÅ¼y, jakby wyczuwaÅ‚a nadciÄ…gajÄ…ce przesilenie. Z poÅ‚udnia nadciÄ…ga echo zwyciÄ™stwa pod CedyniÄ…, ksiÄ…Å¼Ä™ Mieszko triumfuje, Hodon pada pod mieczem Czcibora, a cesarskie spojrzenia kierujÄ… siÄ™ ku naszym granicom.</p>
      <p>Ze wschodu pÅ‚ynie mowa Rusi, Å‚Ä…czÄ…ca bizantyjskie krzyÅ¼e z pradawnymi bÃ³stwami BaÅ‚tyku, niosÄ…c srebro i niepokÃ³j. Z zachodu zaÅ› rozbrzmiewajÄ… wieÅ›ci o chrzcie i kamiennych kaplicach â€“ DÄ…brÃ³wka przynosi pokÃ³j, lecz czy to dar czy nowe kajdany?</p>
      <p>Wy â€“ tkacze, cieÅ›le, zwiadowcy, zielarki, kowale i handlarze â€“ strzeÅ¼ecie pamiÄ™Ä‡ przodkÃ³w: w popiele ognisk, pod korzeniami starych dÄ™bÃ³w i w runach wyrytych na kamieniach.</p>
      <ul>
        <li>Czy otworzyÄ‡ grodzisko na obce mowy i prawo?</li>
        <li>Czy zamknÄ…Ä‡ bramy na sto lat, strzegÄ…c tradycji?</li>
      </ul>
    </div>
    <button class="btn" id="to3">DALEJ</button>
  </div>

  <!-- 3. WybÃ³r postaci -->
  <div id="page3" class="screen">
    <h2>WYBIERZ POSTAÄ†</h2>
    <div class="roles">
      <div class="role" data-role="zwiadowca"><img src="zwiadowca.1.png" alt="Zwiadowca"><p>Zwiadowca</p></div>
      <div class="role" data-role="tkaczka"><img src="tkaczka.1.png" alt="Tkaczka"><p>Tkaczka</p></div>
      <div class="role" data-role="zielarka"><img src="zielarka.1.png" alt="Zielarka"><p>Zielarka</p></div>
      <div class="role" data-role="kupiec"><img src="kupiec.1.png" alt="Kupiec"><p>Kupiec</p></div>
      <div class="role" data-role="rzemieslnik"><img src="rzemieslnik.1.png" alt="RzemieÅ›lnik"><p>RzemieÅ›lnik</p></div>
    </div>
    <button class="btn" id="to4" disabled>DALEJ</button>
  </div>

  <!-- 4. Filmik inicjacyjny -->
  <div id="videoOverlay">
    <video id="roleVideo" controls></video>
    <button class="btn" id="videoNext">DALEJ DO ZADAÅƒ</button>
  </div>

  <!-- 5. Interaktywne zadania -->
  <div id="page4" class="screen">
    <h2>INTERAKTYWNE ZADANIA</h2>
    <div class="instruction-box">
      <p>Wykonajcie 4 gÅ‚Ã³wne zadania oraz 1 zadanie poboczne:</p>
      <button class="btn" id="drawBtn">ğŸ² LOSUJ ZADANIE POBOCZNE</button>
      <p id="randomTask"></p>
      <button class="btn" id="sideBtn" disabled>ZREALIZOWANE</button>
    </div>
    <p>UkoÅ„czono: <span id="count">0</span>/6</p>
    <div id="tasksList">  <!-- zadania list here -->
    </div>
    <button class="btn" id="toCouncil" disabled>PRZEJDÅ¹ DO RADY</button>
  </div>

  <!-- 6. Rada Grodu -->
  <div id="page5" class="screen">
    <h2>RADA GRODU â€“ DECYZYJNA KULMINACJA</h2>
    <button class="btn" id="endTrade">ğŸ›’ Otwarcie na handel</button>
    <button class="btn" id="endClose">ğŸ›¡ï¸ ZamkniÄ™cie granic</button>
    <button class="btn" id="endLaw">âš–ï¸ Wprowadzenie nowego prawa</button>
  </div>

  <!-- 7. Podsumowanie rozgrywki -->
  <div id="page6" class="screen">
    <img src="logo.1.png" class="museum-logo" alt="Muzeum">
    <h1>GRATULACJE!</h1>
    <div id="finalPortrait"><img id="avatar" alt="Twoja postaÄ‡"></div>
    <div class="final-box">
      <p><strong>DruÅ¼yna:</strong> <span id="resTeam"></span></p>
      <p><strong>PostaÄ‡:</strong> <span id="resRole"></span></p>
      <p><strong>Zadania gÅ‚Ã³wne:</strong> <span id="resCount"></span>/6</p>
      <p><strong>Zadanie poboczne:</strong> <span id="resSide"></span></p>
      <p><strong>Decyzja Rady:</strong> <span id="resDec"></span></p>
      <p id="resDesc" style="white-space: pre-wrap; margin-top:8px;"></p>
      <div class="badges"></div>
      <div class="downloads"></div>
      <p class="note">ğŸ… Naklejka korony za zadanie poboczne</p>
    </div>
    <button class="btn" id="restartBtn">ZAGRAJ PONOWNIE</button>
  </div>

  <script>
    // Helper to show screens
    function show(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }
    // Navigation
    document.getElementById('to2').addEventListener('click', () => {
      const input = document.getElementById('teamName');
      if (!input.value.trim()) {
        alert('Podaj nazwÄ™ druÅ¼yny');
      } else {
        team = input.value.trim(); show('page2');
      }
    });
    document.getElementById('to3').addEventListener('click', () => show('page3'));
    document.querySelectorAll('.role').forEach(r => r.addEventListener('click', () => {
      role = r.dataset.role;
      document.querySelectorAll('.role').forEach(x => x.classList.toggle('selected', x === r));
      document.getElementById('to4').disabled = false;
    }));
    document.getElementById('to4').addEventListener('click', () => {
      document.getElementById('roleVideo').src = vids[role];
      showVideoOverlay();
    });
    document.getElementById('videoNext').addEventListener('click', () => { hideVideoOverlay(); show('page4'); });

    // Video overlay
    function showVideoOverlay() { document.getElementById('videoOverlay').style.display = 'flex'; }
    function hideVideoOverlay() { document.getElementById('videoOverlay').style.display = 'none'; }

    // Music toggle
    const musicToggle = document.getElementById('musicToggle');
    const bgMusic = document.getElementById('bgMusic');
    musicToggle.addEventListener('click', () => {
      if (bgMusic.paused) { bgMusic.play(); musicToggle.classList.remove('muted'); } else { bgMusic.pause(); musicToggle.classList.add('muted'); }
    });

    // Task logic
    let team = '', role = '', count = 0, sideDone = false;
    const vids = { zwiadowca: 'zwiadowca.1.mp4', tkaczka: 'tkaczka.1.mp4', zielarka: 'zielarka.1.mp4', kupiec: 'kupiec.1.mp4', rzemieslnik: 'rzemieslnik.1.mp4' };
    const sideTasks = [
      'ZnajdÅº coÅ› zielonego i dotknij to.', 'ZrÃ³b 5 przysiadÃ³w przy Å‚awce.', 'ZnajdÅº kamieÅ„ wiÄ™kszy niÅ¼ dÅ‚oÅ„.',
      'ZrÃ³b zdjÄ™cie czegoÅ› okrÄ…gÅ‚ego.', 'ZnajdÅº coÅ› na literÄ™ P.', 'Podskocz 3 razy w cieniu.',
      'UÅ‚Ã³Å¼ literÄ™ A z patykÃ³w.', 'Opisz kolor liÅ›cia.', 'ZrÃ³b 10 krokÃ³w do przodu i 5 w bok.',
      'StaÅ„ na jednej nodze i licz do 10 na gÅ‚os.'
    ];
    const endings = {
      handel: { name: 'Otwarcie na handel', desc: `Po dniach peÅ‚nych gorÄ…cych dyskusji, sprzecznych gÅ‚osÃ³w i narad pod gwiazdami, Rada Grodu wyÅ‚oniÅ‚a nowe moÅ¼liwoÅ›ci wymiany. Bramy otwarto, kupcy przybyli z odlegÅ‚ych krain, a w powietrzu unosiÅ‚ siÄ™ zapach przypraw i dÅºwiÄ™k monet. RzemieÅ›lnicy poszerzyli horyzonty, ale rÃ³wnoczeÅ›nie wzrosÅ‚o ryzyko chorÃ³b i oszustw. Grodzisko staÅ‚o siÄ™ prÄ™Å¼nym oÅ›rodkiem handlu - czy zyskaÅ‚o dziÄ™ki temu swe prawdziwe dziedzictwo?` },
      granice: { name: 'ZamkniÄ™cie granic', desc: `W obawie przed nieznanym Rada podjÄ™Å‚a decyzjÄ™ o zamkniÄ™ciu murÃ³w. StraÅ¼e wzmocniono, handel ograniczono, a mieszkaÅ„cy zwrÃ³cili siÄ™ ku wÅ‚asnym plonom. SpokÃ³j zapanowaÅ‚, ale wraz z nim narastaÅ‚a izolacja. Ciche szeptania o bogactwach poza murami pobudzaÅ‚y tÄ™sknotÄ™. Czy bezpieczeÅ„stwo usprawiedliwiÅ‚o utratÄ™ wolnoÅ›ci ducha?` },
      prawo: { name: 'Wprowadzenie nowego prawa', desc: `Pod przewodnictwem starszyzny wprowadzono Å›wieÅ¼e ustawy. KaÅ¼dy â€“ moÅ¼ny i prosty â€“ musiaÅ‚ podporzÄ…dkowaÄ‡ siÄ™ nowym paragrafom. Spory szybko narosÅ‚y, gdy reguÅ‚y interpretowano na rÃ³Å¼ne sposoby. Nowe prawo obiecaÅ‚o porzÄ…dek, ale takÅ¼e rozpoczÄ™Å‚o walkÄ™ o wpÅ‚ywy i odsÅ‚oniÅ‚o pÄ™kniÄ™cia w jednoÅ›ci wspÃ³lnoty. Czy Ã³w Å‚ad zdoÅ‚aÅ‚ przetrwaÄ‡ burze ambicji?` }
    };

    function updateCount() {
      document.getElementById('count').innerText = count;
      document.getElementById('toCouncil').disabled = (count < 4);
    }

    function stripDiacritics(str) {
      return str.normalize('NFD').replace(/[Ì€-Í¯]/g, '');
    }

    document.getElementById('drawBtn').addEventListener('click', () => {
      document.getElementById('randomTask').innerText = sideTasks[Math.floor(Math.random()*sideTasks.length)];
      document.getElementById('sideBtn').disabled = false;
    });
    document.getElementById('sideBtn').addEventListener('click', () => { sideDone = true; document.getElementById('sideBtn').style.background = 'lime'; });

    document.querySelectorAll('.confirm').forEach(btn => {
      btn.addEventListener('click', () => {
        const row = btn.closest('.task-row');
        const ans = row.dataset.ans;
        const val = row.querySelector('input').value.trim().toUpperCase();
        if (stripDiacritics(val) === stripDiacritics(ans)) {
          if (!row.classList.contains('correct')) { row.classList.add('correct'); row.classList.remove('wrong'); count++; }
        } else {
          if (row.classList.contains('correct')) { row.classList.remove('correct'); count--; }
          row.classList.add('wrong');
        }
        updateCount();
      });
    });
    document.querySelectorAll('.reset-icon').forEach(btn => btn.addEventListener('click', () => {
      const row = btn.closest('.task-row');
      if (row.classList.contains('correct')) { row.classList.remove('correct'); count--; }
      row.classList.remove('wrong');
      row.querySelector('input').value = '';
      updateCount();
    }));

    document.getElementById('toCouncil').addEventListener('click', () => show('page5'));
    document.getElementById('endTrade').addEventListener('click', () => finish('handel'));
    document.getElementById('endClose').addEventListener('click', () => finish('granice'));
    document.getElementById('endLaw').addEventListener('click', () => finish('prawo'));

    function finish(dec) {
      document.getElementById('resTeam').innerText = team;
      document.getElementById('resRole').innerText = role;
      document.getElementById('resCount').innerText = count;
      document.getElementById('resSide').innerText = sideDone ? 'TAK' : 'NIE';
      document.getElementById('resDec').innerText = endings[dec].name;
      document.getElementById('resDesc').innerText = endings[dec].desc;
      document.getElementById('avatar').src = role + '.1.png';
      document.querySelector('.badges').innerHTML = `<img src=\"medalion.1.png\" alt=\"Medalion\">${sideDone ? '<img src=\\"korona.1.png\\" alt=\\"Korona\\">' : ''}`;
      document.querySelector('.downloads').innerHTML = `<a href=\"medalion.1.png\" download class=\"btn\">POBIERZ MEDALION</a>${sideDone ? '<a href=\\"korona.1.png\\" download class=\\"btn\\">POBIERZ KORONÄ˜</a>' : ''}`;
      show('page6');
    }

    document.getElementById('restartBtn').addEventListener('click', () => {
      team = ''; role = ''; count = 0; sideDone = false;
      document.getElementById('teamName').value = '';
      document.querySelectorAll('.task-row').forEach(r => r.classList.remove('correct','wrong'));
      document.querySelectorAll('.task-row input').forEach(i => i.value = '');
      document.getElementById('randomTask').innerText = '';
      document.getElementById('sideBtn').disabled = true;
      document.getElementById('sideBtn').style.background = '';
      document.querySelectorAll('.role').forEach(r => r.classList.remove('selected'));
      document.getElementById('to4').disabled = true;
      document.getElementById('toCouncil').disabled = true;
      updateCount();
      show('page1');
    });
  </script>
</body>
</html>
