<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grodowa Odyseja</title>
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    /* Podstawowe style */
    body { margin:0; font-family:'MedievalSharp',cursive; background:url('tÅ‚o gry.png') center/cover fixed; color:#f4f1e6; overflow:hidden; }
    .screen { display:none; padding:20px; min-height:100vh; box-sizing:border-box; }
    .active { display:block; animation:fadeIn 0.8s ease-out; }
    @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
    h1,h2,h3 { text-align:center; font-family:'Uncial Antiqua',cursive; text-shadow:2px 2px 4px rgba(0,0,0,0.6); }
    .btn { background:linear-gradient(to bottom,#c49e5b,#8b6237); color:#fff9e6; padding:12px 24px; border:none; border-radius:8px; margin:10px; font-size:18px; cursor:pointer; transition:transform 0.2s; }
    .btn:hover { transform:scale(1.05); }
    input[type=text] { width:calc(100% - 22px); padding:10px; font-size:16px; border-radius:6px; border:none; margin:10px 0; }
    .instruction-box { background:rgba(0,0,0,0.5); border:1px solid #8d744a; border-radius:8px; padding:15px; max-width:800px; margin:20px auto; }
    /* WybÃ³r postaci */
    .roles { display:flex; justify-content:center; flex-wrap:wrap; gap:20px; margin:30px 0; }
    .role { text-align:center; cursor:pointer; }
    .role img { width:100px; height:140px; border-radius:50%; border:3px solid transparent; transition:border 0.3s; }
    .role:hover img, .role.selected img { border-color:gold; }
    /* Overlay inicjacji */
    #initOverlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); display:none; align-items:center; justify-content:center; z-index:1000; }
    #initBox { background:rgba(20,20,20,0.9); padding:30px; border-radius:12px; text-align:center; width:90%; max-width:400px; }
    #initTitle { margin-bottom:10px; color:#e3c54a; }
    #initDesc { margin-bottom:20px; }
    #initObstacle { width:200px; height:200px; margin:0 auto 20px; background-size:cover; background-position:center; border-radius:12px; box-shadow:0 0 15px rgba(0,0,0,0.6); }
    #initContinue { display:none; }
    /* Panel zadaÅ„ */
    #randomTaskBox { display:flex; flex-wrap:wrap; align-items:center; background:rgba(0,0,0,0.5); padding:15px; border-radius:8px; margin:20px auto; max-width:600px; }
    #randomTask { flex:1; margin-right:10px; word-break:break-word; }
    table { width:90%; margin:20px auto; border-collapse:collapse; }
    th,td { padding:8px; border:1px solid #8d744a; }
  </style>
</head>
<body>
  <audio id="bgMusic" src="celtic-glory-307625.mp3" loop playsinline preload="auto"></audio>

  <!-- Overlay Inicjacji -->
  <div id="initOverlay">
    <div id="initBox">
      <h2 id="initTitle">RytuaÅ‚ Inicjacji</h2>
      <p id="initDesc">PrzeciÄ…gnij, aby odkryÄ‡ kartÄ™ z zadaniami...</p>
      <div id="initObstacle"></div>
      <button class="btn" id="initContinue">DALEJ</button>
    </div>
  </div>

  <!-- Page 1: Rejestracja druÅ¼yny -->
  <div class="screen active" id="page1">
    <h1>GRODOWA ODYSEJA</h1>
    <div class="instruction-box">
      <h2>JAK GRAÄ†?</h2>
      <p>Wpisz nazwÄ™ druÅ¼yny â†’ kliknij DALEJ</p>
      <p>Przeczytaj historiÄ™ â†’ DALEJ</p>
      <p>Wybierz postaÄ‡ â†’ wykonaj rytuaÅ‚</p>
      <p>Kostka â†’ zadanie losowe â†’ ZROBIONE</p>
      <p>OdwiedÅº 4+ punktÃ³w, wpisz sÅ‚owa WIELKIMI LITERAMI</p>
    </div>
    <input type="text" id="teamName" placeholder="Nazwa druÅ¼yny">
    <button class="btn" id="next1">DALEJ</button>
  </div>

  <!-- Page 2: Fabula -->
  <div class="screen" id="page2">
    <h2>WSTÄ˜P FABULARNY</h2>
    <div class="instruction-box">
      <p>Rok 972.</p>
      <p>MÃ³wiÄ…, Å¼e to ostatni spokojny rok. Ziemia drÅ¼y â€“ z poÅ‚udnia wieÅ›ci o zwyciÄ™stwie Mieszka pod CedyniÄ…, ale teÅ¼ o wzmoÅ¼onej uwadze wielkich imperiÃ³w.</p>
      <p>Ze wschodu nadciÄ…gajÄ… nowe prawa i mowa RusÃ³w, ze zÅ‚otym srebrem i niepokojem w gÅ‚osie.</p>
      <p>Z zachodu niesie siÄ™ krzyÅ¼, ktÃ³ry Mieszko przyjÄ…Å‚ dla pokoju, oddajÄ…c DÄ…brÃ³wkÄ™.</p>
      <p>Ale czy pokÃ³j zrodzony z handlu duszami jest trwaÅ‚y?</p>
      <p>Grodzisko Sopockie trwa â€“ ciche, lecz czujne, pamiÄ™ta czasy staroÅ¼ytnych szeptunek i kowali.</p>
      <p>Nie potrzebujemy wojownikÃ³w, lecz straÅ¼nikÃ³w pamiÄ™ci.</p>
      <p>Was â€“ cieÅ›li, tkaczy, zielarek, zwiadowcÃ³w, kupcÃ³w, rzemieÅ›lnikÃ³w.</p>
      <p>Wezwano was do PrÃ³by Dziedzictwa Å»elaza.</p>
      <p>Odnajdziecie Å›lady przeszÅ‚oÅ›ci i zadecydujecie: otworzyÄ‡ bramy na Å›wiat czy trwaÄ‡ przy ogniu przodkÃ³w.</p>
    </div>
    <button class="btn" id="next2">DALEJ</button>
  </div>

  <!-- Page 3: WybÃ³r postaci -->
  <div class="screen" id="page3">
    <h2>WYBIERZ POSTAÄ†</h2>
    <div class="roles">
      <div class="role" data-role="Zwiadowca"><img src="zwiadowca.1.png"><p>Zwiadowca</p></div>
      <div class="role" data-role="Tkaczka"><img src="tkaczka.1.png"><p>Tkaczka</p></div>
      <div class="role" data-role="Zielarka"><img src="zielarka.1.png"><p>Zielarka</p></div>
      <div class="role" data-role="Kupiec"><img src="kupiec.1.png"><p>Kupiec</p></div>
      <div class="role" data-role="RzemieÅ›lnik"><img src="kowal.1.png"><p>RzemieÅ›lnik</p></div>
    </div>
  </div>

  <!-- Page 4: Interaktywne punkty -->
  <div class="screen" id="page4">
    <h2>INTERAKTYWNE PUNKTY</h2>
    <div id="randomTaskBox">
      <span><strong>ZADANIE LOSOWE:</strong> <span id="randomTask">Kliknij kostkÄ™</span></span>
      <button id="randomBtn">ðŸŽ²</button>
      <button id="completeRandom">ZROBIONE</button>
    </div>
    <table>
      <tr><th>PUNKT</th><th>STATUS</th></tr>
      <tr><td>Brama Grodziska</td><td id="s1">â€“</td></tr>
      <tr><td>Warsztat Kowala</td><td id="s2">â€“</td></tr>
      <tr><td>Zagroda</td><td id="s3">â€“</td></tr>
      <tr><td>Chata Tkaczki</td><td id="s4">â€“</td></tr>
      <tr><td>Chata Zielarki</td><td id="s5">â€“</td></tr>
      <tr><td>Chata Namiestnika</td><td id="s6">â€“</td></tr>
    </table>
    <div class="instruction-box"><p style="text-align:center; font-weight:bold;">WPISUJ ODPOWIEDZI WIELKIMI LITERAMI</p></div>
    <button class="btn" id="toCouncil" disabled>PRZEJDÅ¹ DO RADY</button>
  </div>

  <!-- Page 5: Rada Grodu -->
  <div class="screen" id="page5">
    <h2>RADA GRODU</h2>
    <div class="council-cards">
      <div class="card"><h3>Otwarcie na handel</h3><button class="btn" data-dec="Otwarcie na handel">WYBIERAM</button></div>
      <div class="card"><h3>ZamkniÄ™cie granic</h3><button class="btn" data-dec="ZamkniÄ™cie granic">WYBIERAM</button></div>
      <div class="card"><h3>Wprowadzenie nowego prawa</h3><button class="btn" data-dec="Wprowadzenie nowego prawa">WYBIERAM</button></div>
    </div>
  </div>

  <!-- Page 6: Podsumowanie -->
  <div class="screen" id="page6">
    <h2>GRATULACJE!</h2>
    <p>DruÅ¼yna: <strong id="outTeam"></strong></p>
    <p>PostaÄ‡: <strong id="outRole"></strong></p>
    <p>Decyzja: <strong id="outDecision"></strong></p>
    <p>Punkty: <strong id="outPoints"></strong></p>
    <a href="korona.1.png" download class="btn download-btn">POBIERZ KORONÄ˜</a>
    <a href="medalion.1.png" download class="btn download-btn">POBIERZ MEDALION</a>
  </div>

  <script>
    // Muzyka tÅ‚a
    const bg = document.getElementById('bgMusic');
    document.body.addEventListener('click', ()=> bg.play().catch(), { once:true });

    let team='', role='', points=0;
    const randomTasks = [
      'Policzcie razem do 10.', 'StaÅ„cie w rzÄ™dzie...', 'KaÅ¼dy niech dotknie...',
      'ZrÃ³bcie razem zdjÄ™cie.', 'StaÅ„cie w ciszy przez 10s.', 'ZrÃ³bcie klaÅ›niÄ™cie.',
      'PokaÅ¼cie dziwnÄ… minÄ™.', 'PokaÅ¼ palcem w 4 kierunki.', 'Zamknijcie oczy na 5s.',
      'ObrÃ³Ä‡cie siÄ™ w miejscu.'
    ];

    const show = id => {
      document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    };

    // Rejestracja druÅ¼yny
    document.getElementById('next1').onclick = () => {
      const name = document.getElementById('teamName').value.trim();
      if(!name) return alert('Podaj nazwÄ™ druÅ¼yny');
      team = name; show('page2');
    };
    document.getElementById('next2').onclick = () => show('page3');

    // Inicjacja postaci
    document.querySelectorAll('.role').forEach(el => el.onclick = () => {
      role = el.dataset.role;
      const descMap = {
        'Zwiadowca': 'PrzeciÄ…gnij liÅ›cie, by odsÅ‚oniÄ‡ mapÄ™.',
        'Tkaczka': 'PrzeciÄ…gnij po tkaninie wzÃ³r run.',
        'Zielarka': 'PrzeciÄ…gnij zioÅ‚o na zwiÄ™dÅ‚Ä… roÅ›linÄ™.',
        'Kupiec': 'PrzeciÄ…gnij towar do kupca.',
        'RzemieÅ›lnik': 'Stukaj mÅ‚otem w wyznaczone miejsca.'
      };
      document.getElementById('initTitle').innerText = `Inicjacja: ${role}`;
      document.getElementById('initDesc').innerText = descMap[role];
      document.getElementById('initObstacle').style.backgroundImage = `url(${role.toLowerCase()}.obstacle.png)`;
      document.getElementById('initContinue').style.display = 'none';
      document.getElementById('initOverlay').style.display = 'flex';
    });

    // Swipe/klik inicjacyjny
    const obs = document.getElementById('initObstacle'); let sx=0;
    obs.onpointerdown = e => sx = e.clientX;
    obs.onpointerup = e => {
      if(Math.abs(e.clientX - sx) > 50) {
        document.getElementById('initDesc').innerText = 'Karta odsÅ‚oniÄ™ta!';
        document.getElementById('initContinue').style.display = 'inline-block';
      }
    };
    document.getElementById('initContinue').onclick = () => {
      document.getElementById('initOverlay').style.display = 'none';
      show('page4');
    };

    // Zadanie losowe
    document.getElementById('randomBtn').onclick = () => {
      document.getElementById('randomTask').innerText = randomTasks[Math.floor(Math.random()*randomTasks.length)];
    };
    document.getElementById('completeRandom').onclick = () => {
      if(points < 4) {
        points++;
        document.getElementById('completeRandom').classList.add('clicked');
        if(points >= 4) document.getElementById('toCouncil').disabled = false;
      }
    };
    document.getElementById('toCouncil').onclick = () => show('page5');

    // Rada Grodu i podsumowanie
    document.querySelectorAll('#page5 .btn').forEach(btn => btn.onclick = () => {
      const dec = btn.dataset.dec;
      document.getElementById('outTeam').innerText = team;
      document.getElementById('outRole').innerText = role;
      document.getElementById('outDecision').innerText = dec;
      document.getElementById('outPoints').innerText = points;
      show('page6');
    });
  </script>
</body>
</html>
