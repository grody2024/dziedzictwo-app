<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Grodowa Odyseja</title>
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'MedievalSharp',cursive;background:url('tło gry.png') center/cover fixed;color:#f4f1e6;overflow:hidden}
    .screen{display:none;padding:16px;max-width:480px;margin:auto;height:100vh;overflow-y:auto;animation:fadeIn .4s}
    .active{display:block}
    h1,h2{font-family:'Uncial Antiqua',cursive;text-align:center;text-shadow:2px 2px 4px rgba(0,0,0,.6);margin-bottom:12px}
    .btn,input{width:100%;padding:10px;margin:8px 0;border:none;border-radius:6px;font-size:16px}
    .btn{background:linear-gradient(to bottom,#c49e5b,#8b6237);color:#fff9e6;cursor:pointer}
    .btn:disabled{opacity:.6;cursor:default}
    .overlay, .ending{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.85);z-index:1000;flex-direction:column;text-align:center;padding:16px}
    .ending{background:rgba(0,0,0,.7);border:2px solid gold;border-radius:8px;max-width:400px;overflow-y:auto}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
  </style>
</head>
<body>
  <div id="start" class="overlay">
    <h1>GRODOWA ODYSEJA</h1>
    <button id="startBtn" class="btn">▶️ Start</button>
  </div>

  <audio id="bg" src="celtic-glory-307625.mp3" loop playsinline></audio>

  <div id="page1" class="screen">
    <h1>Wpisz nazwę drużyny</h1>
    <input id="team" placeholder="Nazwa drużyny">
    <button class="btn" onclick="if(team.value.trim()){show('page2')}else alert('Podaj nazwę')">Dalej</button>
  </div>

  <div id="page2" class="screen">
    <h2>Rok 972 – Czas Próby</h2>
    <div style="background:rgba(0,0,0,.6);padding:12px;border-radius:8px;line-height:1.4">
      <p>Rok 972. Sopockie Grodzisko pamięta spokój ostatniego lata – lecz teraz Ziemia drży, jakby wyczuwała nadciągające przesilenie.</p>
      <p>Z południa dobiegają echa zwycięstwa pod Cedynią: książę Mieszko triumfuje, Hodon pada pod mieczem Czcibora, a cesarskie spojrzenie zwraca się ku naszym granicom.</p>
      <p>Ze wschodu płynie nowa mowa – twarde znaki Rusi, które łączą bizantyjskie krzyże z pradawnymi bałtyjskimi bóstwami, niosąc srebro i niepokój.</p>
      <p>Z zachodu zaś unoszą się słowa o chrzcie i kaplicach kamiennych: mówią, że Dąbrówka przyniosła pokój, lecz czy pokój wykuwany w żelaznej wierze jest darem czy kajdanami?</p>
      <p>A wy – tkacze, cieśle, zwiadowcy, zielarki, kowale, handlarze – strzeżecie tutaj pamięci przodków: w popiele ognisk, pod korzeniami starych dębów, w runach wyrytych na kamieniu.</p>
      <p>Was wezwano do Próby Dziedzictwa Żelaza. W ciągu godziny odnajdziecie trzy Ślady Przeszłości, by przy Radzie Starszych zadecydować:</p>
      <ul style="list-style:disc inside;margin-left:16px">
        <li>– Czy otworzyć Grodzisko na obce mowy, bogów i prawa…</li>
        <li>– Czy zamknąć bramy na sto lat, strzegąc ognia, który płonął tutaj, zanim wybito pierwsze monety cesarskie.</li>
      </ul>
      <p>Oto wasza chwila – chwila strażników pamięci i kowali nowych losów. Wasza Odyseja Grodowa zaczyna się teraz.</p>
    </div>
    <button class="btn" onclick="show('page3')">Dalej</button>
  </div>

  <div id="page3" class="screen">
    <h2>Wybierz postać</h2>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(80px,1fr));gap:12px">
      <img src="zwiadowca.png" onclick="pick('Zwiadowca','zwiadowca.1.mp4','zwiadowca.png')" id="role_zwiadowca" style="cursor:pointer;border:3px solid transparent;border-radius:8px">
      <img src="tkaczka.png" onclick="pick('Tkaczka','tkaczka.1.mp4','tkaczka.png')" id="role_tkaczka" style="cursor:pointer;border:3px solid transparent;border-radius:8px">
      <img src="zielarka.png" onclick="pick('Zielarka','zielarka.1.mp4','zielarka.png')" id="role_zielarka" style="cursor:pointer;border:3px solid transparent;border-radius:8px">
      <img src="kupiec.png" onclick="pick('Kupiec','kupiec.1.mp4','kupiec.png')" id="role_kupiec" style="cursor:pointer;border:3px solid transparent;border-radius:8px">
      <img src="rzemieslnik.png" onclick="pick('Rzemieślnik','rzemieslnik.1.mp4','rzemieslnik.png')" id="role_rzemieslnik" style="cursor:pointer;border:3px solid transparent;border-radius:8px">
    </div>
    <button id="next3" class="btn" disabled onclick="showVideo()">Dalej</button>
  </div>

  <div id="videoOverlay" class="overlay" style="display:none">
    <video id="roleVideo" controls style="width:90%;max-width:480px;border-radius:12px"></video>
    <button class="btn" onclick="hideVideoAndNext()">Dalej do zadań</button>
  </div>

  <div id="page4" class="screen">
    <h2>Zadania</h2>
    <button class="btn" onclick="draw()">🎲 Losuj poboczne</button>
    <p id="randomTask" style="margin:12px"></p>
    <button id="sideBtn" class="btn" disabled onclick="markSide()">Zrealizowane</button>
    <p>Ukończono: <span id="count">0</span>/6</p>
    <div id="tasksList">
      <div data-ans="LAMELKA" style="margin:8px 0"><span>Brama Grodziska</span><input type="text"><button onclick="check(this)">Zatwierdź</button></div>
      <div data-ans="MIECH" style="margin:8px 0"><span>Warsztat Kowala</span><input type="text"><button onclick="check(this)">Zatwierdź</button></div>
      <div data-ans="ŻYTO" style="margin:8px 0"><span>Zagroda</span><input type="text"><button onclick="check(this)">Zatwierdź</button></div>
      <div data-ans="LEN" style="margin:8px 0"><span>Chata Tkaczki</span><input type="text"><button onclick="check(this)">Zatwierdź</button></div>
      <div data-ans="POKRZYWA" style="margin:8px 0"><span>Chata Zielarki</span><input type="text"><button onclick="check(this)">Zatwierdź</button></div>
      <div data-ans="DIRHEMY" style="margin:8px 0"><span>Chata Namiestnika</span><input type="text"><button onclick="check(this)">Zatwierdź</button></div>
    </div>
    <button id="toCouncil" class="btn" disabled onclick="show('page5')">Przejdź do Rady</button>
  </div>

  <div id="page5" class="screen">
    <h2>Rada Grodu</h2>
    <button class="btn" onclick="finish('handel')">🛒 Otwarcie na handel</button>
    <button class="btn" onclick="finish('granice')">🛡️ Zamknięcie granic</button>
    <button class="btn" onclick="finish('prawo')">⚖️ Nowe prawo</button>
  </div>

  <div id="page6" class="screen">
    <div class="ending">
      <h1>Gratulacje!</h1>
      <p>Drużyna: <strong id="resTeam"></strong></p>
      <p>Postać: <strong id="resRole"></strong></p>
      <div id="desc"></div>
      <p>Zadanie poboczne: <strong id="resSide"></strong></p>
      <p>Ukończono: <strong id="resCount"></strong>/6</p>
      <button class="btn" onclick="location.reload()">Zagraj ponownie</button>
    </div>
  </div>

  <script>
    let team='',role='',roleVid='',roleImg='',count=0,sideDone=false;
    const sideTasks=[
      'Znajdź coś zielonego i dotknij to.',
      'Zrób 5 przysiadów przy ławce.',
      'Znajdź kamień większy niż dłń.',
      'Zrób zdjęcie czegoś okrągłego.',
      'Znajdź coś na literę P.',
      'Podskocz 3 razy w cieniu.',
      'Ułóż literę A z patyków.',
      'Opisz kolor liścia.',
      'Zrób 10 kroków do przodu i 5 w bok.',
      'Stań na jednej nodze i licz do 10 na głos.'
    ];
    const endings={
      handel:{name:'Otwarcie na handel',desc:`Po dniach pełnych gorących dyskusji, sprzecznych głosów i narad pod gwiazdami, Rada Grodu podjęła decyzję, która odmieniła losy krainy. Bramy zostały otwarte, strażnicy powitali pierwsze karawany, a kurz z traktów przyniósł zapachy nieznanych przypraw i szelest monet z odległych królestw.

Lecz z handlem przyszły też cienie. Wieści o znikających dobrach, szpiegach i dziwnych chorobach krążą po zaułkach. Grodowi nie brak bogactwa – lecz czy nie przypłaci go duszą?`},
      granice:{name:'Zamknięcie granic',desc:`Decyzja zapadła w ciszy, przerywanej jedynie trzaskiem pochodni i dźwiękiem zamykanych wrót. Rada Grodu postawiła na bezpieczeństwo. Straże podwojono, mury wzmocniono, a szlaki pokryła trawa zapomnienia. Zapanował porządek, ludzie żyją w spokoju, karmiąc się plonami własnych pól i ufając jedynie tym, których znają od dziecka.

Jednak z każdym dniem grodowe powietrze staje się cięższe. Zaczyna brakować inspiracji, wieści ze świata, nowości. Plotki o tajemniczych sylwetkach za murem, szeptane nocą, zaczynają niepokoić nawet najodważniejszych. Zamknięcie uratowało Grodu ciało – ale czy nie zgubiono jego ducha?`},
      prawo:{name:'Wprowadzenie nowego prawa',desc:`Głos Starszyzny niósł się echem po sali, gdy ogłoszono narodziny nowego ładu. Dotychczasowe zasady – stare jak same mury – ustąpiły miejsca świeżym postanowieniom. Ustawa objęła każdego: możnych i prostych, żołnierzy i zielarki, kupców i bardów. Jedni powitali ją z nadzieją, inni z trwogą.

Nowe prawo dało początek przemianom. Ale z każdym paragrafem rosła też pokusa – nadużycia, spory interpretacyjne, walki o wpływy. Czy Grodowi uda się zachować równowagę między wolą ludu a potrzebą porządku? A może reforma stanie się iskrą większego ognia?`}
    };
    function show(id){['page1','page2','page3','page4','page5','page6'].forEach(p=>document.getElementById(p).classList.remove('active'));document.getElementById(id).classList.add('active')}
    document.getElementById('startBtn').onclick=_=>{team='';show('page1');document.getElementById('bg').play();document.getElementById('start').remove()};
    function pick(r,v,i){role=r;roleVid=v;roleImg=i;document.getElementById('next3').disabled=false;document.querySelectorAll('[id^="role_"]').forEach(el=>el.style.borderColor='transparent');document.getElementById('role_'+r.toLowerCase()).style.borderColor='gold'}
    function showVideo(){document.getElementById('roleVideo').src=roleVid;document.getElementById('videoOverlay').style.display='flex'}
    function hideVideoAndNext(){document.getElementById('videoOverlay').style.display='none';show('page4')}
    function draw(){const t=sideTasks[Math.floor(Math.random()*sideTasks.length)];document.getElementById('randomTask').innerText=t;document.getElementById('sideBtn').disabled=false}
    function markSide(){sideDone=true;document.getElementById('sideBtn').innerText='Zrealizowane'}
    function check(btn){const row=btn.parentNode;const ans=row.getAttribute('data-ans'),val=row.querySelector('input').value.trim().toUpperCase();if(val===ans){updateCount(1);row.querySelector('input').disabled=true;btn.disabled=true;}else alert('Spróbuj ponownie')}    
    function updateCount(delta){count=Math.max(0,count+delta);document.getElementById('count').innerText=count;document.getElementById('toCouncil').disabled=count<4}
    function finish(dec){document.getElementById('resTeam').innerText=team;document.getElementById('resRole').innerText=role;const e=endings[dec];document.getElementById('desc').innerHTML='<h2>'+e.name+'</h2><p>'+e.desc.replace(/\n\n/g,'</p><p>')+'</p>';document.getElementById('resSide').innerText=sideDone?'TAK':'NIE';document.getElementById('resCount').innerText=count;show('page6')}
  </script>
</body>
</html>
