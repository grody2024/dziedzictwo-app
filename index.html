<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Grodowa Odyseja</title>
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'MedievalSharp',cursive;background:url('t≈Ço gry.png') center/cover fixed;color:#f4f1e6;overflow:hidden}
    .screen{display:none;padding:16px;max-width:480px;margin:auto;height:100vh;overflow-y:auto;animation:fadeIn .4s}
    .active{display:block}
    h1,h2{font-family:'Uncial Antiqua',cursive;text-align:center;text-shadow:2px 2px 4px rgba(0,0,0,.6);margin-bottom:12px}
    .btn,input{width:100%;padding:10px;margin:8px 0;border:none;border-radius:6px;font-size:16px}
    .btn{background:linear-gradient(to bottom,#c49e5b,#8b6237);color:#fff9e6;cursor:pointer}
    .btn:disabled{opacity:.6;cursor:default}
    .overlay, .ending{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.85);z-index:1000;flex-direction:column;text-align:center;padding:16px}
    .ending{background:rgba(0,0,0,.7);border:2px solid gold;border-radius:8px;max-width:400px;overflow-y:auto}
    .badges{margin-top:12px;display:flex;gap:12px;justify-content:center}
    .badges img{width:60px}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
  </style>
</head>
<body>
  <!-- Start Overlay -->
  <div id="start" class="overlay">
    <h1>GRODOWA ODYSEJA</h1>
    <button id="startBtn" class="btn">‚ñ∂Ô∏è Start</button>
  </div>

  <audio id="bg" src="celtic-glory-307625.mp3" loop playsinline autoplay muted></audio>

  <!-- Page 1: Registration -->
  <div id="page1" class="screen">
    <h1>Wpisz nazwƒô dru≈ºyny</h1>
    <input id="team" placeholder="Nazwa dru≈ºyny">
    <button class="btn" onclick="if(team.value.trim()){team=team.value.trim();show('page2')}else alert('Podaj nazwƒô')">Dalej</button>
  </div>

  <!-- Page 2: Story -->
  <div id="page2" class="screen">
    <h2>Rok 972 ‚Äì Czas Pr√≥by</h2>
    <div style="background:rgba(0,0,0,.6);padding:12px;border-radius:8px;line-height:1.4">
      <!-- fabu≈Ça -->
      <p>Rok 972. Sopockie Grodzisko pamiƒôta spok√≥j ostatniego lata ‚Äì lecz teraz Ziemia dr≈ºy, jakby wyczuwa≈Ça nadciƒÖgajƒÖce przesilenie.</p>
      <!-- ... pozosta≈Çy opis ... -->
    </div>
    <button class="btn" onclick="show('page3')">Dalej</button>
  </div>

  <!-- Page 3: Choose Role -->
  <div id="page3" class="screen">
    <h2>Wybierz postaƒá</h2>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(80px,1fr));gap:12px">
      <img src="zwiadowca.png" id="role_zwiadowca" onclick="pick('Zwiadowca','zwiadowca.1.mp4','zwiadowca.png')" style="cursor:pointer;border:3px solid transparent;border-radius:8px">
      <!-- inne postacie -->
    </div>
    <button id="next3" class="btn" disabled onclick="showVideo()">Dalej</button>
  </div>

  <!-- Video Overlay -->
  <div id="videoOverlay" class="overlay" style="display:none">
    <video id="roleVideo" controls style="width:90%;max-width:480px;border-radius:12px"></video>
    <button class="btn" onclick="hideVideoAndNext()">Dalej do zada≈Ñ</button>
  </div>

  <!-- Page 4: Tasks -->
  <div id="page4" class="screen">
    <h2>Zadania</h2>
    <button class="btn" onclick="draw()">üé≤ Losuj poboczne</button>
    <p id="randomTask" style="margin:12px"></p>
    <button id="sideBtn" class="btn" disabled onclick="markSide()">Zrealizowane</button>
    <p>Uko≈Ñczono: <span id="count">0</span>/6</p>
    <div id="tasksList">
      <!-- zadania g≈Ç√≥wne, analogicznie -->
    </div>
    <button id="toCouncil" class="btn" disabled onclick="show('page5')">Przejd≈∫ do Rady</button>
  </div>

  <!-- Page 5: Council -->
  <div id="page5" class="screen">
    <h2>Rada Grodu</h2>
    <button class="btn" onclick="finish('handel')">üõí Otwarcie na handel</button>
    <button class="btn" onclick="finish('granice')">üõ°Ô∏è Zamkniƒôcie granic</button>
    <button class="btn" onclick="finish('prawo')">‚öñÔ∏è Nowe prawo</button>
  </div>

  <!-- Page 6: Congratulations -->
  <div id="page6" class="screen">
    <div class="ending">
      <h1>Gratulacje!</h1>
      <p>Dru≈ºyna: <strong id="resTeam"></strong></p>
      <p>Postaƒá: <strong id="resRole"></strong></p>
      <div id="desc"></div>
      <p>Zadanie poboczne: <strong id="resSide"></strong></p>
      <div id="crownMsg" style="margin-top:8px"></div>
      <p>Uko≈Ñczono: <strong id="resCount"></strong>/6</p>
      <div class="badges">
        <img src="medalion.1.png" alt="Medalion">
        <img src="korona.1.png" alt="Korona" id="badgeCrown" style="display:none">
      </div>
      <button class="btn" onclick="location.reload()">Zagraj ponownie</button>
    </div>
  </div>

  <script>
    let team='',role='',roleVid='',roleImg='',count=0,sideDone=false;
    const sideTasks = [/* ... */];
    const endings = {/* ... */};
    function show(id){['page1','page2','page3','page4','page5','page6'].forEach(p=>document.getElementById(p).classList.remove('active'));document.getElementById(id).classList.add('active')}
    document.getElementById('startBtn').onclick = ()=>{ document.getElementById('bg').play().catch(()=>{}); document.getElementById('bg').muted=false; show('page1'); document.getElementById('start').remove(); }
    function pick(r,v,i){ role=r; roleVid=v; roleImg=i; document.getElementById('next3').disabled=false; document.querySelectorAll('[id^="role_"]').forEach(el=>el.style.borderColor='transparent'); document.getElementById('role_'+r.toLowerCase()).style.borderColor='gold'; }
    function showVideo(){ document.getElementById('roleVideo').src=roleVid; document.getElementById('videoOverlay').style.display='flex'; }
    function hideVideoAndNext(){ document.getElementById('videoOverlay').style.display='none'; show('page4'); }
    function draw(){ const t=sideTasks[Math.floor(Math.random()*sideTasks.length)]; document.getElementById('randomTask').innerText=t; document.getElementById('sideBtn').disabled=false; }
    function markSide(){ sideDone=true; document.getElementById('sideBtn').innerText='Zrealizowane'; }
    function updateCount(d){ count=Math.max(0,count+d); document.getElementById('count').innerText=count; document.getElementById('toCouncil').disabled = count<4; }
    function check(btn){ const row=btn.parentNode; const ans=row.getAttribute('data-ans'); const val=row.querySelector('input').value.trim().toUpperCase(); if(val===ans){ updateCount(1); btn.disabled=true; row.querySelector('input').disabled=true; } else alert('Spr√≥buj ponownie'); }
    function finish(dec){ document.getElementById('resTeam').innerText=team; document.getElementById('resRole').innerText=role; const e=endings[dec]; document.getElementById('desc').innerHTML='<h2>'+e.name+'</h2><p>'+e.desc.replace(/\n\n/g,'</p><p>')+'</p>'; document.getElementById('resSide').innerText=sideDone?'TAK':'NIE'; if(sideDone){ document.getElementById('crownMsg').innerText='Otrzymujesz koronƒô zada≈Ñ!'; document.getElementById('badgeCrown').style.display='inline'; } document.getElementById('resCount').innerText=count; show('page6'); }
  </script>
</body>
</html>
