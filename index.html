<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Grodowa Odyseja</title>
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    body { margin:0; font-family:'MedievalSharp',cursive; background:url('t≈Ço gry.png') center/cover fixed; color:#f4f1e6; overflow-x:hidden; overflow-y:auto; -webkit-overflow-scrolling:touch; }
    @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
    .screen { display:none; padding:20px; min-height:100vh; box-sizing:border-box; animation:fadeIn .5s ease-out; }
    .active { display:block; }
    h1,h2,h3 { text-align:center; font-family:'Uncial Antiqua',cursive; text-shadow:2px 2px 4px rgba(0,0,0,0.6); margin-bottom:16px; }
    .btn { display:inline-block; background:linear-gradient(to bottom,#c49e5b,#8b6237); color:#fff9e6; padding:12px 24px; border:none; border-radius:8px; margin:8px; font-size:18px; cursor:pointer; transition:transform .2s; }
    .btn:disabled { opacity:.5; cursor:default; }
    .btn:hover:not(:disabled) { transform:scale(1.05); }
    input[type=text] { width:100%; padding:12px; font-size:16px; border-radius:6px; border:none; margin:8px 0; box-sizing:border-box; }
    .instruction-box { background:rgba(0,0,0,0.5); border:2px solid #8d744a; border-radius:8px; padding:16px; max-width:800px; margin:16px auto; text-align:left; }
    .instruction-box ul { padding-left:20px; }
    .logo { display:block; width:80px; margin:12px auto; border:3px solid gold; border-radius:8px; }
    .roles { display:flex; justify-content:center; flex-wrap:wrap; gap:16px; margin:24px 0; }
    .role { text-align:center; flex:0 1 120px; cursor:pointer; }
    .role img { width:120px; height:140px; border-radius:60px; border:3px solid transparent; transition:border .3s,box-shadow .3s; }
    .role.selected img { border-color:gold; animation:blink 1s infinite; }
    @keyframes blink { 0%,100%{box-shadow:0 0 8px gold;}50%{box-shadow:0 0 2px gold;} }
    #videoOverlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:none; align-items:center; justify-content:center; flex-direction:column; z-index:1000; }
    #videoOverlay video { max-width:90%; border:3px solid #8d744a; border-radius:12px; }
    #randomTaskBox { background:rgba(0,0,0,0.5); padding:16px; border-radius:8px; margin:20px auto; max-width:600px; text-align:center; }
    #randomTask { color:#fff; margin-bottom:8px; font-size:16px; }
    #taskStats { text-align:center; margin:12px 0; }
    #tasksList { max-width:600px; margin:0 auto; }
    .task-row { display:flex; align-items:center; justify-content:space-between; margin:8px 0; }
    .task-row input { width:120px; padding:6px; border-radius:4px; border:2px solid #444; }
    .task-row.correct input { border-color:lime; background:rgba(0,128,0,0.2); }
    .task-row.wrong input { border-color:crimson; background:rgba(255,0,0,0.2); }
    #needFour { text-align:center; font-style:italic; margin:16px 0; background:rgba(0,0,0,0.5); padding:12px; border-radius:8px; }
    .badges { display:flex; justify-content:center; gap:24px; margin:16px 0; }
    .badges img { width:100px; border:2px solid #8d744a; border-radius:8px; }
    #finalPortrait img { display:block; margin:0 auto 12px; width:120px; height:140px; border-radius:60px; border:3px solid #8d744a; }
    #downloads a { margin:8px; }
  </style>
</head>
<body>
  <audio id="bgMusic" src="celtic-glory-307625.mp3" loop playsinline preload="auto"></audio>

  <!-- Page1 -->
  <div class="screen active" id="page1">
    <h1>GRODOWA ODYSEJA</h1>
    <img src="logo.1.png" class="logo" alt="Logo">
    <div class="instruction-box">
      <h2>JAK GRAƒÜ?</h2>
      <ul>
        <li>Wpisz nazwƒô dru≈ºyny ‚Üí <strong>DALEJ</strong></li>
        <li>Przeczytaj fabu≈Çƒô ‚Üí <strong>DALEJ</strong></li>
        <li>Wybierz postaƒá ‚Üí <strong>DALEJ</strong></li>
        <li>Obejrzyj filmik ‚Üí przejd≈∫ do zada≈Ñ</li>
        <li>Wylosuj zadanie poboczne ‚Üí <strong>ZROBIONE</strong></li>
        <li>Wykonaj min. 4 zadania g≈Ç√≥wne</li>
        <li>Zatwierd≈∫ s≈Çowa WIELKIMI LITERAMI</li>
        <li><strong>PRZEJD≈π DO RADY</strong></li>
      </ul>
    </div>
    <input type="text" id="teamName" placeholder="Nazwa dru≈ºyny">
    <button class="btn" id="next1">DALEJ</button>
  </div>

  <!-- Page2 -->
  <div class="screen" id="page2">
    <h2>Rok 972 ‚Äì Czas Pr√≥by</h2>
    <div class="instruction-box">
      <p>Wok√≥≈Ç Grodu nadciƒÖgajƒÖ zmiany...</p>
      <!-- ...kr√≥tka fabu≈Ça... -->
    </div>
    <button class="btn" id="next2">DALEJ</button>
  </div>

  <!-- Page3: postaci -->
  <div class="screen" id="page3">
    <h2>WYBIERZ POSTAƒÜ</h2>
    <div class="roles">
      <div class="role" data-role="zwiadowca"><img src="zwiadowca.1.png"><p>Zwiadowca</p></div>
      <div class="role" data-role="tkaczka"><img src="tkaczka.1.png"><p>Tkaczka</p></div>
      <div class="role" data-role="zielarka"><img src="zielarka.1.png"><p>Zielarka</p></div>
      <div class="role" data-role="kupiec"><img src="kupiec.1.png"><p>Kupiec</p></div>
      <div class="role" data-role="rzemieslnik"><img src="kowal.1.png"><p>Rzemie≈õlnik</p></div>
    </div>
    <button class="btn" id="next3" disabled>DALEJ</button>
  </div>

  <!-- Video -->
  <div id="videoOverlay">
    <video id="roleVideo" controls></video>
    <button class="btn" id="videoNext">DALEJ DO ZADA≈É</button>
  </div>

  <!-- Page4: Zadania -->
  <div class="screen" id="page4">
    <h2>ZADANIA</h2>
    <div id="randomTaskBox">
      <em>Wykonuj samodzielnie, nikt nic nie wpisuje</em>
      <div id="randomTask">Kliknij üé≤, aby wylosowaƒá zadanie poboczne</div>
      <button class="btn" id="randomBtn">üé≤</button>
      <button class="btn" id="sideDone" disabled>ZROBIONE</button>
    </div>
    <div id="taskStats">Uko≈Ñczono: <strong id="completedCount">0</strong>/6</div>
    <div id="tasksList">
      <div class="task-row" data-ans="LAMELKA"><span>Brama Grodziska</span><input><button class="btn confirm">Zatwierd≈∫</button></div>
      <div class="task-row" data-ans="MIECH"><span>Warsztat Kowala</span><input><button class="btn confirm">Zatwierd≈∫</button></div>
      <div class="task-row" data-ans="≈ªYTO"><span>Zagroda</span><input><button class="btn confirm">Zatwierd≈∫</button></div>
      <div class="task-row" data-ans="LEN"><span>Chata Tkaczki</span><input><button class="btn confirm">Zatwierd≈∫</button></div>
      <div class="task-row" data-ans="POKRZYWA"><span>Chata Zielarki</span><input><button class="btn confirm">Zatwierd≈∫</button></div>
      <div class="task-row" data-ans="DIRHEMY"><span>Chata Namiestnika</span><input><button class="btn confirm">Zatwierd≈∫</button></div>
    </div>
    <div id="needFour">Aby przej≈õƒá dalej do Rady, musisz poprawnie wykonaƒá minimum 4 zadania.</div>
    <button class="btn" id="toCouncil" disabled>PRZEJD≈π DO RADY</button>
  </div>

  <!-- Page5: Rada -->
  <div class="screen" id="page5">
    <h2>RADA GRODU</h2>
    <div class="roles council-cards">
      <div class="role"><h3>üõí Otwarcie na handel</h3><button class="btn" data-dec="handel">WYBIERAM</button></div>
      <div class="role"><h3>üõ°Ô∏è Zamkniƒôcie granic</h3><button class="btn" data-dec="granice">WYBIERAM</button></div>
      <div class="role"><h3>‚öñÔ∏è Wprowadzenie nowego prawa</h3><button class="btn" data-dec="prawo">WYBIERAM</button></div>
    </div>
  </div>

  <!-- Page6: Podsumowanie -->
  <div class="screen" id="page6">
    <h1>GRATULACJE!</h1>
    <img src="logo.1.png" class="logo" alt="Logo">
    <div id="finalPortrait"><img id="outPortrait" alt="Twoja postaƒá"></div>
    <p>Dru≈ºyna: <strong id="outTeam"></strong></p>
    <p>Postaƒá: <strong id="outRole"></strong></p>
    <p>Decyzja: <strong id="outDecisionName"></strong></p>
    <p id="outDecisionDesc" style="max-width:800px;margin:12px auto;line-height:1.4;"></p>
    <p>Zadanie poboczne wykonane: <strong id="outSideDone"></strong></p>
    <p>Uko≈Ñczono zada≈Ñ g≈Ç√≥wnych: <strong id="outPoints"></strong>/6</p>
    <div id="badges" class="badges"></div>
    <div id="downloads" style="text-align:center;"></div>
  </div>

  <script>
    const bg = document.getElementById('bgMusic');
    document.body.addEventListener('click', ()=>bg.play().catch(), { once:true });

    let team='', role='', completed=0, sideDone=false;
    const sideTasks = [
      'Znajd≈∫ co≈õ zielonego i dotknij to.',
      'Zr√≥b 5 przysiad√≥w przy najbli≈ºszej ≈Çawce.',
      'Znajd≈∫ kamie≈Ñ wiƒôkszy ni≈º twoja d≈Ço≈Ñ.',
      'Zr√≥b zdjƒôcie (lub poka≈º palcem) czego≈õ, co jest okrƒÖg≈Çe.',
      'Znajd≈∫ co≈õ, co zaczyna siƒô na literƒô ‚ÄûP‚Äù.',
      'Podskocz 3 razy w miejscu, gdzie jest cie≈Ñ.',
      'U≈Ç√≥≈º z patyk√≥w literƒô A na ziemi.',
      'Znajd≈∫ li≈õƒá i opisz jego kolor.',
      'Zr√≥b 10 krok√≥w do przodu, potem 5 w bok i znajd≈∫ co≈õ ciekawego.',
      'Sta≈Ñ na jednej nodze i policz do 10 na g≈Ços.'
    ];

    const endings = {
      handel: { name:'Otwarcie na handel', desc:`Po dniach pe≈Çnych gorƒÖcych dyskusji...` },
      granice:{ name:'Zamkniƒôcie granic', desc:`Decyzja zapad≈Ça w ciszy...` },
      prawo:{ name:'Wprowadzenie nowego prawa', desc:`G≈Ços Starszyzny ni√≥s≈Ç siƒô echem...` }
    };

    function show(id){ document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active')); document.getElementById(id).classList.add('active'); }

    document.getElementById('next1').onclick = ()=>{
      const v=document.getElementById('teamName').value.trim();
      if(!v){ alert('Podaj nazwƒô dru≈ºyny'); return; }
      team=v; show('page2');
    };
    document.getElementById('next2').onclick = ()=> show('page3');
    document.querySelectorAll('#page3 .role').forEach(el=>el.onclick = ()=>{
      document.querySelectorAll('#page3 .role').forEach(r=>r.classList.remove('selected'));
      el.classList.add('selected'); role=el.dataset.role;
      document.getElementById('next3').disabled=false;
    });
    document.getElementById('next3').onclick = ()=>{
      const vids={ zwiadowca:'zwiadowca.1.mp4', tkaczka:'tkaczka.1.mp4', zielarka:'zielarka.1.mp4', kupiec:'kupiec.1.mp4', rzemieslnik:'rzemieslnik.1.mp4' };
      document.getElementById('roleVideo').src=vids[role]; document.getElementById('videoOverlay').style.display='flex';
    };
    document.getElementById('videoNext').onclick = ()=>{
      completed=0; sideDone=false;
      document.getElementById('videoOverlay').style.display='none'; show('page4');
      document.getElementById('sideDone').disabled=false; document.getElementById('randomTask').innerText='Kliknij üé≤, aby wylosowaƒá zadanie poboczne';
      document.getElementById('completedCount').innerText='0'; document.getElementById('toCouncil').disabled=true;
      document.querySelectorAll('.task-row').forEach(r=>{r.classList.remove('correct','wrong'); r.querySelector('input').value='';});
    };
    document.getElementById('randomBtn').onclick = ()=>{ document.getElementById('randomTask').innerText = sideTasks[Math.floor(Math.random()*sideTasks.length)]; };
    document.getElementById('sideDone').onclick = ()=>{ sideDone=true; document.getElementById('sideDone').style.background='lime'; document.getElementById('sideDone').innerText='ZROBIONE'; };
    document.querySelectorAll('.task-row').forEach((row,i)=>{
      const ans=row.dataset.ans; const inp=row.querySelector('input');
      row.querySelector('.confirm').onclick = ()=>{
        if(inp.value.trim().toUpperCase()===ans){ row.classList.add('correct'); row.classList.remove('wrong'); completed++; }
        else { row.classList.add('wrong'); row.classList.remove('correct'); if(completed>0) completed--; }
        document.getElementById('completedCount').innerText=completed;
        if(completed>=4) document.getElementById('toCouncil').disabled=false;
      };
    });
    document.getElementById('toCouncil').onclick = ()=> show('page5');
    document.querySelectorAll('#page5 .btn').forEach(b=>b.onclick = ()=>{
      const key=b.dataset.dec;
      document.getElementById('outTeam').innerText=team;
      document.getElementById('outRole').innerText=role;
      document.getElementById('outDecisionName').innerText=endings[key].name;
      document.getElementById('outDecisionDesc').innerText=endings[key].desc;
      document.getElementById('outSideDone').innerText=sideDone?'TAK':'NIE';
      document.getElementById('outPoints').innerText=completed;
      // portrait
      document.getElementById('outPortrait').src = role + '.png';
      // badges
      const bcont = document.getElementById('badges'); bcont.innerHTML = '';
      // medalion
      bcont.innerHTML += `<div><img src="medalion.1.png"><p>Medalion Grodu</p></div>`;
      if(sideDone) bcont.innerHTML += `<div><img src="korona.1.png"><p>Korona Wyzwa≈Ñ</p></div>`;
      // downloads
      const dl = document.getElementById('downloads'); dl.innerHTML = '';
      dl.innerHTML += `<a href="medalion.1.png" download class="btn">POBIERZ MEDALION</a>`;
      if(sideDone) dl.innerHTML += `<a href="korona.1.png" download class="btn">POBIERZ KORONƒò</a>`;
      show('page6');
    });
  </script>
</body>
</html>
