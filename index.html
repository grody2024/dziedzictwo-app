<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Grodowa Odyseja</title>
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    body { margin:0; font-family:'MedievalSharp',cursive; background:url('tÅ‚o gry.png') center/cover fixed; color:#f4f1e6; overflow-x:hidden; overflow-y:auto; -webkit-overflow-scrolling:touch; }
    .screen { display:none; padding:20px; min-height:100vh; box-sizing:border-box; }
    .active { display:block; animation:fadeIn 0.5s ease-out; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    h1,h2,h3 { text-align:center; font-family:'Uncial Antiqua',cursive; text-shadow:2px 2px 4px rgba(0,0,0,0.6); margin-bottom:16px; }
    .btn { display:inline-block; background:linear-gradient(to bottom,#c49e5b,#8b6237); color:#fff9e6; padding:12px 24px; border:none; border-radius:8px; margin:8px; font-size:18px; cursor:pointer; transition:transform 0.2s; }
    .btn:disabled { opacity:0.5; cursor:default; }
    .btn:hover:not(:disabled) { transform:scale(1.05); }
    input[type=text] { width:100%; padding:12px; font-size:16px; border-radius:6px; border:none; margin:8px 0; box-sizing:border-box; }
    .instruction-box { background:rgba(0,0,0,0.5); border:2px solid #8d744a; border-radius:8px; padding:16px; max-width:800px; margin:16px auto; }
    .logo { display:block; width:80px; margin:12px auto; border:3px solid gold; border-radius:8px; }
    .roles { display:flex; justify-content:center; flex-wrap:wrap; gap:16px; margin:24px 0; }
    .role { text-align:center; flex:0 1 120px; cursor:pointer; }
    .role img { width:120px; height:120px; border-radius:50%; border:3px solid transparent; transition:border 0.3s; }
    .role.selected img { border-color:gold; }
    #videoOverlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:none; align-items:center; justify-content:center; z-index:1000; flex-direction:column; }
    #videoOverlay video { max-width:90%; border:3px solid #8d744a; border-radius:12px; }
    #randomTaskBox { background:rgba(0,0,0,0.5); padding:16px; border-radius:8px; margin:20px auto; max-width:600px; text-align:center; }
    #randomTask { color:#fff; margin-bottom:8px; }
    #taskStats { text-align:center; margin:12px 0; }
    .task-row { display:flex; align-items:center; justify-content:space-between; margin:8px auto; max-width:600px; }
    .task-row input { width:120px; margin:0 8px; padding:6px; border-radius:4px; border:none; }
    .task-row.correct input { border:2px solid lime; }
    table { display:none; }
  </style>
</head>
<body>
  <audio id="bgMusic" src="celtic-glory-307625.mp3" loop playsinline preload="auto"></audio>

  <!-- Page 1: Registration -->
  <div class="screen active" id="page1">
    <h1>GRODOWA ODYSEJA</h1>
    <img src="logo.1.png" class="logo" alt="Logo">
    <div class="instruction-box">
      <p><strong>Wpisz nazwÄ™ druÅ¼yny:</strong></p>
      <input type="text" id="teamName" placeholder="Twoja druÅ¼yna">
      <button class="btn" id="next1">DALEJ</button>
    </div>
  </div>

  <!-- Page 2: Story -->
  <div class="screen" id="page2">
    <h2>Rok 972 â€“ Czas PrÃ³by</h2>
    <div class="instruction-box">
      <p>WokÃ³Å‚ Grodu nadciÄ…gajÄ… zmiany.</p>
      <p>Na poÅ‚udniu Mieszko zwyciÄ™Å¼a pod CedyniÄ…, lecz imperia patrzÄ… coraz Å‚apczywiej.</p>
      <p>Ze wschodu nadchodzi nowe pismo, z zachodu â€“ nowa wiara.</p>
      <p>Grodzisko Sopockie trwa â€“ ciche, ale czujne.</p>
      <p>PamiÄ™ta czasy przodkÃ³w, kowali, starszyzny i szeptunek.</p>
      <p>DziÅ› to wy â€“ mieszkaÅ„cy Grodu â€“ staniecie do PrÃ³by Dziedzictwa Å»elaza.</p>
      <p>Odnajdziecie Å›lady przeszÅ‚oÅ›ci i zdecydujecie, czy Grodzisko otworzy siÄ™ na Å›wiatâ€¦</p>
      <p>â€¦czy zamknie siÄ™, by chroniÄ‡ to, co stare i Å›wiÄ™te.</p>
    </div>
    <button class="btn" id="next2">DALEJ</button>
  </div>

  <!-- Page 3: Choose Role -->
  <div class="screen" id="page3">
    <h2>WYBIERZ POSTAÄ†</h2>
    <div class="roles">
      <div class="role" data-role="Zwiadowca"><img src="zwiadowca.1.png"><p>Zwiadowca</p></div>
      <div class="role" data-role="Tkaczka"><img src="tkaczka.1.png"><p>Tkaczka</p></div>
      <div class="role" data-role="Zielarka"><img src="zielarka.1.png"><p>Zielarka</p></div>
      <div class="role" data-role="Kupiec"><img src="kupiec.1.png"><p>Kupiec</p></div>
      <div class="role" data-role="RzemieÅ›lnik"><img src="kowal.1.png"><p>RzemieÅ›lnik</p></div>
    </div>
    <button class="btn" id="next3" disabled>DALEJ</button>
  </div>

  <!-- Video Overlay -->
  <div id="videoOverlay">
    <video id="roleVideo" controls></video>
    <button class="btn" id="videoNext">DALEJ DO ZADAÅƒ</button>
  </div>

  <!-- Page 4: Side Task & Main Tasks -->
  <div class="screen" id="page4">
    <h2>INTERAKTYWNE ZADANIA</h2>
    <div id="randomTaskBox">
      <div id="randomTask">Kliknij ðŸŽ², aby wylosowaÄ‡ zadanie poboczne</div>
      <button class="btn" id="randomBtn">ðŸŽ²</button>
    </div>
    <div id="taskStats">UkoÅ„czono: <span id="completedCount">0</span>/6</div>
    <div id="tasksList">
      <div class="task-row" data-ans="LAMELKA"><span>Brama Grodziska</span><input type="text"><button class="btn confirm">ZatwierdÅº</button></div>
      <div class="task-row" data-ans="MIECH"><span>Warsztat Kowala</span><input type="text"><button class="btn confirm">ZatwierdÅº</button></div>
      <div class="task-row" data-ans="Å»YTO"><span>Zagroda</span><input type="text"><button class="btn confirm">ZatwierdÅº</button></div>
      <div class="task-row" data-ans="LEN"><span>Chata Tkaczki</span><input type="text"><button class="btn confirm">ZatwierdÅº</button></div>
      <div class="task-row" data-ans="POKRZYWA"><span>Chata Zielarki</span><input type="text"><button class="btn confirm">ZatwierdÅº</button></div>
      <div class="task-row" data-ans="DIRHEMY"><span>Chata Namiestnika</span><input type="text"><button class="btn confirm">ZatwierdÅº</button></div>
    </div>
    <button class="btn" id="toCouncil" disabled>PRZEJDÅ¹ DO RADY</button>
  </div>

  <!-- Page 5: Council -->
  <div class="screen" id="page5">
    <h2>RADA GRODU</h2>
    <div class="roles council-cards">
      <div class="role"><h3>Otwarcie na handel</h3><button class="btn" data-dec="Otwarcie na handel">WYBIERAM</button></div>
      <div class="role"><h3>ZamkniÄ™cie granic</h3><button class="btn" data-dec="ZamkniÄ™cie granic">WYBIERAM</button></div>
      <div class="role"><h3>Wprowadzenie nowego prawa</h3><button class="btn" data-dec="Wprowadzenie nowego prawa">WYBIERAM</button></div>
    </div>
  </div>

  <!-- Page 6: Summary -->
  <div class="screen" id="page6">
    <h1>GRATULACJE!</h1>
    <img src="logo.1.png" class="logo" alt="Logo">
    <p>DruÅ¼yna: <strong id="outTeam"></strong></p>
    <p>PostaÄ‡: <strong id="outRole"></strong></p>
    <p>Decyzja: <strong id="outDecision"></strong></p>
    <p>UkoÅ„czono zadaÅ„: <strong id="outPoints"></strong>/6</p>
    <a href="korona.1.png" download class="btn">POBIERZ KORONÄ˜</a>
    <a href="medalion.1.png" download class="btn">POBIERZ MEDALION</a>
  </div>

  <script>
    // Music start
    const bg = document.getElementById('bgMusic');
    document.body.addEventListener('click',()=>bg.play().catch(),{once:true});

    let team='', role='', completed=0;
    const sideTasks = [
      'MÄ…droÅ›Ä‡ PrzodkÃ³w', 'KrÄ…g Zgody', 'Wilcze Oko',
      'Szlak Cieni', 'PieÅ›Å„ Ziemi', 'Dar PrzodkÃ³w',
      'Szept Lasu', 'GÅ‚os Rodu'
    ];

    function show(id){
      document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    // Page1 -> Page2
    document.getElementById('next1').onclick=()=>{
      const n=document.getElementById('teamName').value.trim();
      if(!n){alert('Podaj nazwÄ™ druÅ¼yny');return;}
      team=n; show('page2');
    };

    // Page2 -> Page3
    document.getElementById('next2').onclick=()=>show('page3');

    // Role select
    document.querySelectorAll('#page3 .role').forEach(el=>{
      el.onclick=()=>{
        document.querySelectorAll('#page3 .role').forEach(r=>r.classList.remove('selected'));
        el.classList.add('selected');
        role=el.dataset.role;
        document.getElementById('next3').disabled=false;
      };
    });

    // Page3 -> Video overlay
    document.getElementById('next3').onclick=()=>{
      const vids={Zwiadowca:'zwiadowca.1.mp4',Tkaczka:'tkaczka.1.mp4',Zielarka:'zielarka.1.mp4',Kupiec:'kupiec.1.mp4',RzemieÅ›lnik:'rzemieslnik.1.mp4'};
      const vid=document.getElementById('roleVideo');
      vid.src=vids[role];
      document.getElementById('videoOverlay').style.display='flex';
    };

    // Video -> Page4
    document.getElementById('videoNext').onclick=()=>{
      document.getElementById('videoOverlay').style.display='none';
      show('page4');
    };

    // Side quest
    document.getElementById('randomBtn').onclick=()=>{
      document.getElementById('randomTask').innerText = sideTasks[Math.floor(Math.random()*sideTasks.length)];
    };

    // Main tasks validation
    document.querySelectorAll('.task-row').forEach(row=>{
      const ans=row.dataset.ans;
      const input=row.querySelector('input');
      const btn=row.querySelector('.confirm');
      btn.onclick=()=>{
        if(input.value.trim().toUpperCase()===ans && !row.classList.contains('correct')){
          row.classList.add('correct');
          completed++;
          document.getElementById('completedCount').innerText=completed;
          if(completed>=4) document.getElementById('toCouncil').disabled=false;
        }
      };
    });

    // Page4 -> Page5
    document.getElementById('toCouncil').onclick=()=>show('page5');

    // Council -> Summary
    document.querySelectorAll('#page5 .btn').forEach(b=>{
      b.onclick=()=>{
        document.getElementById('outTeam').innerText=team;
        document.getElementById('outRole').innerText=role;
        document.getElementById('outDecision').innerText=b.dataset.dec;
        document.getElementById('outPoints').innerText=completed;
        show('page6');
      };
    });
  </script>
</body>
</html>
