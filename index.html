<!-- Plik: index.html -->
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>Grodowa Odyseja</title>
  <!-- Czcionki ≈õredniowieczne -->
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body {
      font-family: 'MedievalSharp', cursive;
      background: url('tlo-gry.png') center/cover fixed;
      color: #f4f1e6;
      overflow: hidden;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .screen {
      display: none;
      animation: fadeIn .4s;
      padding: 16px;
      max-width: 480px;
      margin: auto;
      min-height: 100vh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    .active { display: block; }

    h1, h2, h3 {
      text-align: center;
      font-family: 'Uncial Antiqua', cursive;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, .6);
      margin-bottom: 12px;
    }

    input[type=text] { width:100%; padding:10px; margin:8px 0; border:none; border-radius:6px; font-size:16px; }
    .btn { width:100%; padding:12px; margin:8px 0; font-size:18px; border:none; border-radius:8px; background:linear-gradient(to bottom, #c49e5b, #8b6237); color:#fff9e6; cursor:pointer; }
    .btn:disabled { opacity:.6; cursor:default; }

    .instruction-box, .final-box { background:rgba(0,0,0,.6); border:2px solid #8d744a; border-radius:8px; padding:12px; margin:12px 0; font-size:14px; line-height:1.4; }
    .instruction-box ul { list-style:disc inside; margin-left:16px; }

    .roles { display:grid; grid-template-columns:repeat(auto-fit, minmax(80px, 1fr)); gap:12px; justify-items:center; }
    .role { background:rgba(0,0,0,.5); padding:6px; border-radius:12px; text-align:center; cursor:pointer; transition:transform .2s; }
    .role:hover { transform:translateY(-4px); }
    .role img { width:80px; height:80px; object-fit:cover; object-position:top center; border-radius:12px; border:2px solid transparent; }
    .role.selected img { border-color:gold; box-shadow:0 0 6px gold; }

    #videoOverlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.9); display:none; align-items:center; justify-content:center; flex-direction:column; z-index:1000; padding:16px; }
    #videoOverlay video { width:90%; max-width:360px; border-radius:12px; }

    .task-row { display:flex; gap:8px; align-items:center; margin:8px 0; }
    .task-row span { flex:1; }
    .task-row input { flex:1 1 100px; padding:6px; border:2px solid #444; border-radius:4px; }
    .task-row.correct input { border-color:lime; background:rgba(0,128,0,.2); }
    .task-row.wrong input { border-color:crimson; background:rgba(255,0,0,.2); }
    .reset-icon { background:none; border:none; font-size:18px; cursor:pointer; }

    #page6 { display:flex; flex-direction:column; align-items:center; text-align:center; padding:16px; background:rgba(0,0,0,.6); border-radius:12px; box-shadow:0 0 12px rgba(0,0,0,.8); max-height:90vh; overflow-y:auto; }
    .museum-logo { width:60px; margin-bottom:8px; border:2px solid gold; padding:2px; border-radius:6px; }
    #finalPortrait img { width:80px; max-height:120px; object-fit:cover; object-position:top center; border-radius:10px; border:3px solid gold; padding:1px; }
    .badges, .downloads { display:flex; flex-wrap:wrap; gap:8px; margin:8px 0; }
    .note { font-size:12px; color:#ddd; margin-top:8px; }

    @media (max-width:400px) { .btn { font-size:14px; padding:8px; } h1{font-size:24px;} h2{font-size:20px;} .instruction-box{font-size:12px;} }
    #restartBtn { font-size:20px; padding:16px; margin-top:12px; }
  </style>
</head>
<body>
  <audio id="bgMusic" autoplay loop playsinline></audio>

  <!-- 1. Instrukcja gry -->
  <div id="page1" class="screen active">
    <h1>GRODOWA ODYSEJA</h1>
    <div class="instruction-box">
      <h3>Mechanika gry ‚ÄûDziedzictwo‚Äù</h3>
      <p>1. Wprowadzenie fabularne ‚Äì zapoznajcie siƒô z realiami Pomorza X wieku.</p>
      <p>2. Tworzenie dru≈ºyny ‚Äì wybierzcie nazwƒô dru≈ºyny, wprowadzajƒÖc jƒÖ poni≈ºej.</p>
      <p>3. Wyb√≥r postaci ‚Äì ka≈ºda rola niesie unikalne mo≈ºliwo≈õci.</p>
      <p>4. Zadania ‚Äì wykonajcie 4 z 6 g≈Ç√≥wnych zada≈Ñ oraz 1 poboczne.</p>
      <p>5. Rada Grodu ‚Äì wybierzcie decyzjƒô, kt√≥ra zadecyduje o losach grodu.</p>
    </div>
    <input id="teamName" type="text" placeholder="Nazwa dru≈ºyny">
    <button class="btn" id="to2">DALEJ</button>
  </div>

  <!-- 2. Pe≈Çna fabu≈Ça -->
  <div id="page2" class="screen">
    <h2>PE≈ÅNA FABU≈ÅA</h2>
    <div class="instruction-box">
      <p>Rok 972. Sopockie Grodzisko pamiƒôta spok√≥j ostatniego lata ‚Äì lecz teraz Ziemia dr≈ºy...</p>
      <ul>
        <li>‚Ä¶Echo Cedyni</li>
        <li>‚Ä¶Wp≈Çywy Rusi</li>
        <li>‚Ä¶G≈Ços DƒÖbr√≥wki</li>
      </ul>
    </div>
    <button class="btn" id="to3">DALEJ</button>
  </div>

  <!-- 3. Wyb√≥r postaci -->
  <div id="page3" class="screen">
    <h2>WYBIERZ POSTAƒÜ</h2>
    <div class="roles">
      <div class="role" data-role="zwiadowca"><img src="zwiadowca.1.png" alt="Zwiadowca"><p>Zwiadowca</p></div>
      <div class="role" data-role="tkaczka"><img src="tkaczka.1.png" alt="Tkaczka"><p>Tkaczka</p></div>
      <div class="role" data-role="zielarka"><img src="zielarka.1.png" alt="Zielarka"><p>Zielarka</p></div>
      <div class="role" data-role="kupiec"><img src="kupiec.1.png" alt="Kupiec"><p>Kupiec</p></div>
      <div class="role" data-role="rzemieslnik"><img src="rzemieslnik.1.png" alt="Rzemie≈õlnik"><p>Rzemie≈õlnik</p></div>
    </div>
    <button class="btn" id="to4" disabled>DALEJ</button>
  </div>

  <!-- 4. Filmik inicjacyjny -->
  <div id="videoOverlay">
    <video id="roleVideo" controls></video>
    <button class="btn" id="videoNext">DALEJ DO ZADA≈É</button>
  </div>

  <!-- 5. Interaktywne zadania -->
  <div id="page4" class="screen">
    <h2>INTERAKTYWNE ZADANIA</h2>
    <div class="instruction-box">
      <p>Wykonaj 4 g≈Ç√≥wne zadania: Brama Grodziska, Warsztat Kowala, Chata Zielarki, Chata Tkaczki, Ratusz, Targowisko oraz 1 zadanie poboczne.</p>
      <button class="btn" id="drawBtn">üé≤ LOSUJ ZADANIE POBOCZNE</button>
      <p id="randomTask"></p>
      <button class="btn" id="sideBtn" disabled>ZREALIZOWANE</button>
    </div>
    <p>Uko≈Ñczono: <span id="count">0</span>/6</p>
    <div id="tasksList">
      <div class="task-row" data-ans="LAMELKA"><span>Brama Grodziska</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon" title="Resetuj">üîÑ</button></div>
      <div class="task-row" data-ans="MIECH"><span>Warsztat Kowala</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon" title="Resetuj">üîÑ</button></div>
      <div class="task-row" data-ans="ZYTO"><span>Targowisko</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon" title="Resetuj">üîÑ</button></div>
      <div class="task-row" data-ans="LEN"><span>Chata Tkaczki</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon" title="Resetuj">üîÑ</button></div>
      <div class="task-row" data-ans="POKRZYWA"><span>Chata Zielarki</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon" title="Resetuj">üîÑ</button></div>
      <div class="task-row" data-ans="DIRHEMY"><span>Ratusz</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon" title="Resetuj">üîÑ</button></div>
    </div>
    <button class="btn" id="toCouncil" disabled>PRZEJD≈π DO RADY</button>
  </div>

  <!-- 6. Rada Grodu -->
  <div id="page5" class="screen">
    <h2>RADA GRODU ‚Äì DECYZYJNA KULMINACJA</h2>
    <button class="btn" id="endTrade">üõí Otwarcie na handel</button>
    <button class="btn" id="endClose">üõ°Ô∏è Zamkniƒôcie granic</button>
    <button class="btn" id="endLaw">‚öñÔ∏è Wprowadzenie nowego prawa</button>
  </div>

  <!-- 7. Podsumowanie rozgrywki -->
  <div id="page6" class="screen">
    <img src="logo.1.png" class="museum-logo" alt="Muzeum">
    <h1>GRATULACJE!</h1>
    <div id="finalPortrait"><img id="avatar" alt="Twoja postaƒá"></div>
    <div class="final-box">
      <p><strong>Dru≈ºyna:</strong> <span id="resTeam"></span></p>
      <p><strong>Postaƒá:</strong> <span id="resRole"></span></p>
      <p><strong>Zadania g≈Ç√≥wne:</strong> <span id="resCount">0</span>/6</p>
      <p><strong>Zadanie poboczne:</strong> <span id="resSide"></span></p>
      <p><strong>Decyzja Rady:</strong> <span id="resDec"></span></p>
      <p id="resDesc" style="white-space: pre-wrap; margin-top:8px"></p>
      <div class="badges"></div>
      <div class="downloads"></div>
      <p class="note">üèÖ Naklejkƒô korony otrzymuje ten, kto wykona≈Ç zadanie losowe.</p>
    </div>
    <button class="btn" id="restartBtn">ZAGRAJ PONOWNIE</button>
  </div>

  <script>
    const musicTracks = ['celtic-festival-307626.mp3'];
    const bgMusic = document.getElementById('bgMusic');
    function startBackgroundMusic() { bgMusic.src = musicTracks[0]; bgMusic.load(); bgMusic.play().catch(()=>{});}    
    document.getElementById('teamName').addEventListener('input', startBackgroundMusic, { once:true });

    let team='', role='', count=0, sideDone=false;
    const vids={zwiadowca:'zwiadowca.1.mp4',tkaczka:'tkaczka.1.mp4',zielarka:'zielarka.1.mp4',kupiec:'kupiec.1.mp4',rzemieslnik:'rzemieslnik.1.mp4'};
    const sideTasks=['Znajd≈∫ co≈õ zielonego i dotknij to.','Zr√≥b 5 przysiad√≥w przy ≈Çawce.','Znajd≈∫ kamie≈Ñ wiƒôkszy ni≈º d≈Ço≈Ñ.','Zr√≥b zdjƒôcie czego≈õ okrƒÖg≈Çego.','Znajd≈∫ co≈õ na literƒô P.','Podskocz 3 razy w cieniu.','U≈Ç√≥≈º literƒô A z patyk√≥w.','Opisz kolor li≈õcia.','Zr√≥b 10 krok√≥w do przodu i 5 w bok.','Sta≈Ñ na jednej nodze i licz do 10 na g≈Ços.'];
    const endings={handel:{name:'Otwarcie na handel',desc:`Po dniach pe≈Çnych gorƒÖcych dyskusji, sprzecznych g≈Ços√≥w i narad pod gwiazdami, Rada Grodu wy≈Çoni≈Ça nowe mo≈ºliwo≈õci wymiany. Bramy otwarto, kupcy przybyli z odleg≈Çych krain, a w powietrzu unosi≈Ç siƒô zapach przypraw i d≈∫wiƒôk monet. Rzemie≈õlnicy poszerzyli horyzonty, ale r√≥wnocze≈õnie wzros≈Ço ryzyko chor√≥b i oszustw. Grodzisko sta≈Ço siƒô prƒô≈ºnym o≈õrodkiem handlu - czy zyska≈Ço dziƒôki temu swe prawdziwe dziedzictwo?`},granice:{name:'Zamkniƒôcie granic',desc:`W obawie przed nieznanym Rada podjƒô≈Ça decyzjƒô o zamkniƒôciu mur√≥w. Stra≈ºe wzmocniono, handel ograniczono, a mieszka≈Ñcy zwr√≥cili siƒô ku w≈Çasnym plonom. Spok√≥j zapanowa≈Ç, ale wraz z nim narasta≈Ça izolacja. Ciche szeptania o bogactwach poza murami pobudza≈Çy tƒôsknotƒô. Czy bezpiecze≈Ñstwo usprawiedliwi≈Ço utratƒô wolno≈õci ducha?`},prawo:{name:'Wprowadzenie nowego prawa',desc:`Pod przewodnictwem starszyzny wprowadzono ≈õwie≈ºe ustawy. Ka≈ºdy ‚Äì mo≈ºny i prosty ‚Äì musia≈Ç podporzƒÖdkowaƒá siƒô nowym paragrafom. Spory szybko naros≈Çy, gdy regu≈Çy interpretowano na r√≥≈ºne sposoby. Nowe prawo obieca≈Ço porzƒÖdek, ale tak≈ºe rozpoczƒô≈Ço walkƒô o wp≈Çywy i ods≈Çoni≈Ço pƒôkniƒôcia w jedno≈õci wsp√≥lnoty. Czy √≥w ≈Çad zdo≈Ça≈Ç przetrwaƒá burze ambicji?`}};

    function show(id){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));document.getElementById(id).classList.add('active');}
    document.getElementById('to2').addEventListener('click',()=>{const i=document.getElementById('teamName');if(!i.value.trim())alert('Podaj nazwƒô dru≈ºyny');else{team=i.value.trim();show('page2');}});
    document.getElementById('to3').addEventListener('click',()=>show('page3'));
    document.querySelectorAll('.role').forEach(el=>el.addEventListener('click',()=>{role=el.dataset.role;document.querySelectorAll('.role').forEach(r=>r.classList.toggle('selected',r===el));document.getElementById('to4').disabled=false;}));
    document.getElementById('to4').addEventListener('click',()=>{document.getElementById('roleVideo').src=vids[role];document.getElementById('videoOverlay').style.display='flex';});
    document.getElementById('videoNext').addEventListener('click',()=>{document.getElementById('videoOverlay').style.display='none';show('page4');updateStats();});

    function updateStats(){document.getElementById('count').innerText=count;document.getElementById('toCouncil').disabled=(count<4);}    
    function stripDiacritics(str){return str.normalize('NFD').replace(/[ÃÄ-ÕØ]/g,'');}
    document.querySelectorAll('.confirm').forEach(btn=>btn.addEventListener('click',()=>{const row=btn.closest('.task-row');const ans=row.dataset.ans;const val=row.querySelector('input').value.trim().toUpperCase();if(stripDiacritics(val)===stripDiacritics(ans)){if(!row.classList.contains('correct')){row.classList.remove('wrong');row.classList.add('correct');count++;}}else{if(row.classList.contains('correct')){row.classList.remove('correct');count--;}row.classList.add('wrong');}updateStats();}));
    document.querySelectorAll('.reset-icon').forEach(btn=>btn.addEventListener('click',()=>{const row=btn.closest('.task-row');if(row.classList.contains('correct')){row.classList.remove('correct');count--;}row.classList.remove('wrong');row.querySelector('input').value='';updateStats();}));
    document.getElementById('drawBtn').addEventListener('click',()=>{document.getElementById('randomTask').innerText=sideTasks[Math.floor(Math.random()*sideTasks.length)];document.getElementById('sideBtn').disabled=false;});
    document.getElementById('sideBtn').addEventListener('click',()=>{sideDone=true;document.getElementById('sideBtn').style.background='lime';updateStats();});
    document.getElementById('toCouncil').addEventListener('click',()=>show('page5'));
    document.getElementById('endTrade').addEventListener('click',()=>finish('handel'));document.getElementById('endClose').addEventListener('click',()=>finish('granice'));document.getElementById('endLaw').addEventListener('click',()=>finish('prawo'));
    function finish(dec){document.getElementById('resTeam').innerText=team;document.getElementById('resRole').innerText=role;document.getElementById('resDec').innerText=endings[dec].name;document.getElementById('resDesc').innerText=endings[dec].desc;document.getElementById('avatar').src=role+'.1.png';document.getElementById('resSide').innerText=sideDone?'TAK':'NIE';document.getElementById('resCount').innerText=count;document.querySelector('.badges').innerHTML=`<img src="medalion.1.png" alt="Medalion">${sideDone?'<img src="korona.1.png" alt="Korona">':''}`;document.querySelector('.downloads').innerHTML=`<a href="medalion.1.png" download class="btn">POBIERZ MEDALION</a>${sideDone?'<a href="korona.1.png" download class="btn">POBIERZ KORONƒò</a>':''}`;show('page6');}
    document.getElementById('restartBtn').addEventListener('click',()=>{team='';role='';count=0;sideDone=false;document.getElementById('teamName').value='';document.querySelectorAll('.task-row').forEach(r=>r.classList.remove('correct','wrong'));document.querySelectorAll('.task-row input').forEach(i=>i.value='');document.getElementById('randomTask').innerText='';document.getElementById('sideBtn').disabled=true;document.getElementById('sideBtn').style.background='';document.querySelectorAll('.role').forEach(r=>r.classList.remove('selected'));document.getElementById('to4').disabled=true;document.getElementById('toCouncil').disabled=true;updateStats();show('page1');});
  </script>
</body>
</html>
