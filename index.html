<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
  <title>Grodowa Odyseja</title>
  <!-- Czcionki stylizujƒÖce na ≈õredniowieczne pismo -->
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    /* --- Reset + podstawy --- */
    * { box-sizing:border-box; margin:0; padding:0; }
    html, body { height:100%; }
    body {
      font-family:'MedievalSharp',cursive;
      background:url('t≈Ço gry.png') center/cover fixed;
      color:#f4f1e6;
      overflow:hidden;
    }

    @keyframes fadeIn {
      from { opacity:0; }
      to   { opacity:1; }
    }

    .screen {
      display:none;
      animation:fadeIn .4s;
      padding:16px;
      max-width:480px;
      margin:auto;
      height:100vh;
      overflow-y:auto;
    }
    .active { display:block; }

    h1, h2, h3 {
      text-align:center;
      font-family:'Uncial Antiqua',cursive;
      text-shadow:2px 2px 4px rgba(0,0,0,.6);
      margin-bottom:12px;
    }

    input[type=text] {
      width:100%; padding:10px; margin:8px 0;
      border:none; border-radius:6px; font-size:16px;
    }

    .btn {
      width:100%; padding:12px; margin:8px 0;
      font-size:18px; border:none; border-radius:8px;
      background:linear-gradient(to bottom,#c49e5b,#8b6237);
      color:#fff9e6; cursor:pointer;
    }
    .btn:disabled { opacity:.6; cursor:default; }

    .instruction-box {
      background:rgba(0,0,0,.6);
      border:2px solid #8d744a; border-radius:8px;
      padding:12px; margin:12px 0; font-size:14px;
      line-height:1.4;
    }
    .instruction-box ul { list-style:disc inside; margin-left:16px; }

    /* Role grid */
    .roles {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(100px,1fr));
      gap:16px; justify-items:center;
    }
    .role {
      background:rgba(0,0,0,.5); padding:8px;
      border-radius:12px; text-align:center;
      cursor:pointer; transition:transform .2s;
    }
    .role img {
      width:100px; height:100px; object-fit:cover;
      object-position:top center; border-radius:12px;
      border:3px solid transparent;
    }
    .role.selected img {
      border-color:gold; box-shadow:0 0 8px gold;
    }

    /* Video overlay for intro */
    #videoOverlay {
      position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,.9);
      display:none; align-items:center; justify-content:center;
      flex-direction:column; z-index:1000; padding:16px;
    }
    #videoOverlay video {
      width:90%; max-width:480px; border-radius:12px;
    }

    /* Tasks screen */
    .task-row {
      display:flex; gap:8px; align-items:center;
      margin:8px 0;
    }
    .task-row span { flex:1; }
    .task-row input {
      flex:1 1 100px; padding:6px;
      border:2px solid #444; border-radius:4px;
    }
    .task-row.correct input {
      border-color:lime; background:rgba(0,128,0,.2);
    }
    .task-row.wrong input {
      border-color:crimson; background:rgba(255,0,0,.2);
    }
    .reset-icon {
      background:none; border:none;
      font-size:20px; cursor:pointer;
    }

    @media(max-width:400px) {
      .btn { font-size:16px; padding:10px; }
      .role img { max-width:80px; height:80px; }
    }
  </style>
</head>
<body onclick="if(bgMusic.muted){ bgMusic.muted=false; }}">

  <!-- Audio w tle: losowy wyb√≥r spo≈õr√≥d dostƒôpnych ≈õcie≈ºek -->
  <audio id="bgMusic" muted autoplay loop></audio>

  <!-- 1. Rejestracja dru≈ºyny -->
  <div id="page1" class="screen active">
    <h1>GRODOWA ODYSEJA</h1>
    <div class="instruction-box">
      <ul>
        <li>1. Wpisz nazwƒô dru≈ºyny ‚Üí <strong>DALEJ</strong></li>
        <li>2. Przeczytaj fabu≈Çƒô ‚Üí <strong>DALEJ</strong></li>
        <li>3. Wybierz postaƒá ‚Üí <strong>DALEJ</strong></li>
        <li>4. Obejrzyj filmik ‚Üí <strong>DALEJ</strong></li>
        <li>5. Wylosuj zadanie poboczne ‚Üí <strong>üé≤ LOSUJ</strong></li>
        <li>6. Po realizacji otrzymujesz koronƒô ‚Üí <strong>ZREALIZOWANE</strong></li>
        <li>7. Wykonaj min. 4 zadania g≈Ç√≥wne</li>
        <li>8. Kliknij <strong>PRZEJD≈π DO RADY</strong></li>
      </ul>
    </div>
    <input id="teamName" type="text" placeholder="Nazwa dru≈ºyny">
    <button class="btn" onclick="if(!teamName.value.trim()){alert('Podaj nazwƒô dru≈ºyny');}else{team=teamName.value.trim();show('page2');}">DALEJ</button>
  </div>

  <!-- 2. Fabu≈Ça gry -->
  <div id="page2" class="screen">
    <h2>Rok 972 ‚Äì Czas Pr√≥by</h2>
    <div class="instruction-box">
      <p>Rok 972. Sopockie Grodzisko pamiƒôta spok√≥j ostatniego lata ‚Äì lecz teraz Ziemia dr≈ºy, jakby wyczuwa≈Ça nadciƒÖgajƒÖce przesilenie.</p>
      <p>Z po≈Çudnia dobiegajƒÖ echa zwyciƒôstwa pod CedyniƒÖ: ksiƒÖ≈ºƒô Mieszko triumfuje, Hodon pada pod mieczem Czcibora, a cesarskie spojrzenie zwraca siƒô ku naszym granicom.</p>
      <p>Ze wschodu p≈Çynie nowa mowa ‚Äì twarde znaki Rusi, kt√≥re ≈ÇƒÖczƒÖ bizantyjskie krzy≈ºe z pradawnymi ba≈Çtyckimi b√≥stwami, niosƒÖc srebro i niepok√≥j.</p>
      <p>Z zachodu za≈õ unoszƒÖ siƒô s≈Çowa o chrzcie i kaplicach kamiennych: m√≥wiƒÖ, ≈ºe DƒÖbr√≥wka przynios≈Ça pok√≥j, lecz czy pok√≥j wykuwany w ≈ºelaznej wierze jest darem czy kajdanami?</p>
      <p>A wy ‚Äì tkacze, cie≈õle, zwiadowcy, zielarki, kowale, handlarze ‚Äì strze≈ºecie tutaj pamiƒôci przodk√≥w: w popiele ognisk, pod korzeniami starych dƒôb√≥w, w runach wyrytych na kamieniu.</p>
      <p>Was wezwano do Pr√≥by Dziedzictwa ≈ªelaza. W ciƒÖgu godziny odnajdziecie trzy ≈ölady Przesz≈Ço≈õci, by przy Radzie Starszych zadecydowaƒá:</p>
      <ul>
        <li>‚Äì Czy otworzyƒá Grodzisko na obce mowy, bog√≥w i prawa‚Ä¶</li>
        <li>‚Äì Czy zamknƒÖƒá bramy na sto lat, strzegƒÖc ognia, kt√≥ry p≈ÇonƒÖ≈Ç tutaj, zanim wybito pierwsze monety cesarskie.</li>
      </ul>
      <p>Oto wasza chwila ‚Äì chwila stra≈ºnik√≥w pamiƒôci i kowali nowych los√≥w. Wasza Odyseja Grodowa zaczyna siƒô teraz.</p>
    </div>
    <button class="btn" onclick="show('page3')">DALEJ</button>
  </div>

  <!-- 3. Wyb√≥r postaci -->
  <div id="page3" class="screen">
    <h2>WYBIERZ POSTAƒÜ</h2>
    <div class="roles">
      <div class="role" data-role="zwiadowca" onclick="pick('zwiadowca')">
        <img src="zwiadowca.1.png" alt="Zwiadowca"><p>Zwiadowca</p>
      </div>
      <div class="role" data-role="tkaczka" onclick="pick('tkaczka')">
        <img src="tkaczka.1.png" alt="Tkaczka"><p>Tkaczka</p>
      </div>
      <div class="role" data-role="zielarka" onclick="pick('zielarka')">
        <img src="zielarka.1.png" alt="Zielarka"><p>Zielarka</p>
      </div>
      <div class="role" data-role="kupiec" onclick="pick('kupiec')">
        <img src="kupiec.1.png" alt="Kupiec"><p>Kupiec</p>
      </div>
      <div class="role" data-role="rzemieslnik" onclick="pick('rzemieslnik')">
        <img src="rzemieslnik.png" alt="Rzemie≈õlnik"><p>Rzemie≈õlnik</p>
      </div>
    </div>
    <button id="btn3" class="btn" disabled onclick="showVideo()">DALEJ</button>
  </div>

  <!-- 4. Filmik inicjacyjny postaci -->
  <div id="videoOverlay">
    <video id="roleVideo" controls></video>
    <button class="btn" onclick="hideVideoAndNext()">DALEJ DO ZADA≈É</button>
  </div>

  <!-- 5. Zadania -->
  <div id="page4" class="screen">
    <h2>ZADANIA</h2>
    <div class="instruction-box">
      <button class="btn" onclick="draw()">üé≤ LOSUJ</button>
      <p id="randomTask"></p>
      <button id="sideBtn" class="btn" disabled onclick="markSide()">ZREALIZOWANE</button>
    </div>
    <p>Uko≈Ñczono: <span id="count">0</span>/6</p>
    <div id="tasksList">
      <div class="task-row" data-ans="LAMELKA"><span>Brama Grodziska</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="MIECH"><span>Warsztat Kowala</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="≈ªYTO"><span>Zagroda</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="LEN"><span>Chata Tkaczki</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="POKRZYWA"><span>Chata Zielarki</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="DIRHEMY"><span>Chata Namiestnika</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
    </div>
    <button id="toCouncil" class="btn" disabled onclick="show('page5')">PRZEJD≈π DO RADY</button>
  </div>

  <!-- 6. Rada Grodu -->
  <div id="page5" class="screen">
    <h2>RADA GRODU</h2>
    <button class="btn" onclick="finish('handel')">üõí Otwarcie na handel</button>
    <button class="btn" onclick="finish('granice')">üõ°Ô∏è Zamkniƒôcie granic</button>
    <button class="btn" onclick="finish('prawo')">‚öñÔ∏è Wprowadzenie nowego prawa</button>
  </div>

  <!-- 7. (Ukryty) Gratulacje -->
  <div id="page6" class="screen">
    <img src="logo.1.png" class="museum-logo" alt="Muzeum">
    <h1>GRATULACJE!</h1>
    <div id="finalPortrait"><img id="avatar" alt="Twoja postaƒá"></div>
    <p>Dru≈ºyna: <span id="resTeam"></span></p>
    <p>Postaƒá: <span id="resRole"></span></p>
    <p>Decyzja: <span id="resDec"></span></p>
    <p id="resDesc" style="white-space:pre-wrap;max-width:400px;margin:auto;"></p>
    <p>Zadanie poboczne: <span id="resSide"></span></p>
    <p>Uko≈Ñczono: <span id="resCount"></span>/6</p>
    <div class="badges"></div>
    <div class="downloads"></div>
    <button class="btn" onclick="restart()">ZAGRAJ PONOWNIE</button>
  </div>

  <script>
    // Lista dostƒôpnych utwor√≥w muzycznych
    const musicTracks = [
      'celtycki-festiwal-307626.mp3',
      'celtycki-taniec-skrzypcowy-307624.mp3',
      'celtic-glory-307625.mp3',
      'celtyckie-legendy-307629.mp3',
      'celtycki-poranny-telefon-307627.mp3'
    ];
    const bgMusic = document.getElementById('bgMusic');
    // Wyb√≥r losowego utworu przy starcie
    bgMusic.src = musicTracks[Math.floor(Math.random()*musicTracks.length)];

    let team='', role='', count=0, sideDone=false;
    const vids = {
      zwiadowca:'zwiadowca.1.mp4',
      tkaczka:'tkaczka.1.mp4',
      zielarka:'zielarka.1.mp4',
      kupiec:'kupiec.1.mp4',
      rzemieslnik:'rzemieslnik.1.mp4'
    };
    const sideTasks = [
      'Znajd≈∫ co≈õ zielonego i dotknij to.',
      'Zr√≥b 5 przysiad√≥w przy ≈Çawce.',
      'Znajd≈∫ kamie≈Ñ wiƒôkszy ni≈º d≈Ç≈Ñ.',
      'Zr√≥b zdjƒôcie czego≈õ okrƒÖg≈Çego.',
      'Znajd≈∫ co≈õ na literƒô P.',
      'Podskocz 3 razy w cieniu.',
      'U≈Ç√≥≈º literƒô A z patyk√≥w.',
      'Opisz kolor li≈õcia.',
      'Zr√≥b 10 krok√≥w do przodu i 5 w bok.',
      'Sta≈Ñ na jednej nodze i licz do 10 na g≈Ços.'
    ];
    const endings = {
      handel: { name:'Otwarcie na handel', desc:'Po dniach pe≈Çnych gorƒÖcych dyskusji, ‚Ä¶ duszƒÖ?' },
      granice:{ name:'Zamkniƒôcie granic', desc:'Decyzja zapad≈Ça w ciszy, ‚Ä¶ ducha?' },
      prawo:{ name:'Wprowadzenie nowego prawa', desc:'G≈Ços Starszyzny ni√≥s≈Ç siƒô echem, ‚Ä¶ ognia?' }
    };

    function show(id){ document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active')); document.getElementById(id).classList.add('active'); }
    function pick(r){ role=r; document.querySelectorAll('#page3 .role').forEach(el=>el.classList.toggle('selected',el.dataset-role===r)); document.getElementById('btn3').disabled=false; }
    function showVideo(){ document.getElementById('roleVideo').src=vids[role]; document.getElementById('videoOverlay').style.display='flex'; }
    function hideVideoAndNext(){ document.getElementById('videoOverlay').style.display='none'; show('page4'); }
    function updateStats(){ document.getElementById('count').innerText=count; document.getElementById('toCouncil').disabled = count<4; }
    document.querySelectorAll('.confirm').forEach(btn=>{ btn.onclick=()=>{ const row=btn.closest('.task-row'); const ans=row.dataset.ans, val=row.querySelector('input').value.trim().toUpperCase(); if(val===ans){ if(!row.classList.contains('correct')){ row.classList.remove('wrong'); row.classList.add('correct'); count++; }} else { if(row.classList.contains('correct')){ row.classList.remove('correct'); count--; } row.classList.add('wrong'); } updateStats(); }; });
    document.querySelectorAll('.reset-icon').forEach(btn=>{ btn.onclick=()=>{ const row=btn.closest('.task-row'); if(row.classList.contains('correct')){ row.classList.remove('correct'); count--; } row.classList.remove('wrong'); row.querySelector('input').value=''; updateStats(); }; });
    function draw(){ document.getElementById('randomTask').innerText = sideTasks[Math.floor(Math.random()*sideTasks.length)]; document.getElementById('sideBtn').disabled=false; }
    function markSide(){ sideDone=true; document.getElementById('sideBtn').style.background='lime'; }
    function finish(dec){ team=document.getElementById('teamName').value; document.getElementById('resTeam').innerText=team; document.getElementById('resRole').innerText=role; document.getElementById('resDec').innerText=endings[dec].name; document.getElementById('resDesc').innerText=endings[dec].desc; document.getElementById('avatar').src=role+'.png'; document.getElementById('resSide').innerText=sideDone?'TAK':'NIE'; document.getElementById('resCount').innerText=count; document.querySelector('.badges').innerHTML = '<img src="medalion.1.png" alt="Medalion">' + (sideDone?'<img src="korona.1.png" alt="Korona">':''); document.querySelector('.downloads').innerHTML = '<a href="medalion.1.png" download class="btn">POBIERZ MEDALION</a>' + (sideDone?'<a href="korona.1.png" download class="btn">POBIERZ KORONƒò</a>':''); show('page6'); }
    function restart(){ team=''; role=''; count=0; sideDone=false; document.getElementById('teamName').value=''; document.querySelectorAll('.task-row').forEach(r=>{ r.classList.remove('correct','wrong'); r.querySelector('input').value=''; }); updateStats(); show('page1'); }
  </script>
</body>
</html>
