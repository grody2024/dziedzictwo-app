<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Grodowa Odyseja</title>
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body { overflow: hidden; font-family: 'MedievalSharp', cursive; background: url('t≈Ço gry.png') center/cover fixed; color: #f4f1e6; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .screen { display: none; padding: 16px; height: 100vh; overflow-y: auto; max-width: 480px; margin: auto; animation: fadeIn .5s; }
    .active { display: block; }
    h1,h2,h3 { text-align: center; font-family: 'Uncial Antiqua', cursive; text-shadow: 2px 2px 4px rgba(0,0,0,0.6); margin-bottom: 12px; }
    input[type=text] { width: 100%; padding: 10px; font-size: 16px; border: none; border-radius: 6px; margin: 8px 0; }
    .btn { width: 100%; background: linear-gradient(to bottom, #c49e5b, #8b6237); color: #fff9e6; padding: 12px; border: none; border-radius: 8px; font-size: 18px; margin: 8px 0; cursor: pointer; }
    .btn:disabled { opacity: .6; cursor: default; }
    .instruction-box { background: rgba(0,0,0,0.6); border: 2px solid #8d744a; border-radius: 8px; padding: 12px; margin: 12px 0; font-size: 14px; line-height: 1.4; }
    .instruction-box ul { list-style: disc inside; margin-left: 16px; }
    .roles { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px,1fr)); gap: 16px; justify-items: center; }
    .role { background: rgba(0,0,0,0.5); padding: 8px; border-radius: 12px; transition: transform .3s, background .3s; cursor: pointer; text-align: center; }
    .role img { width: 100px; height: 100px; object-fit: cover; border-radius: 50%; border: 3px solid transparent; }
    .role.selected img { border-color: gold; box-shadow: 0 0 8px gold; }
    #videoOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; flex-direction: column; z-index: 1000; padding: 16px; }
    #videoOverlay video { width: 90%; max-width: 480px; border-radius: 12px; }
    .task-row { display: flex; gap: 8px; align-items: center; margin: 8px 0; }
    .task-row span { flex: 1; }
    .task-row input { flex: 1 1 100px; padding: 6px; border: 2px solid #444; border-radius: 4px; }
    .task-row.correct input { border-color: lime; background: rgba(0,128,0,0.2); }
    .task-row.wrong input { border-color: crimson; background: rgba(255,0,0,0.2); }
    .reset-icon { background: none; border: none; font-size: 20px; cursor: pointer; }
    #needFour { text-align: center; font-style: italic; margin: 12px 0; }
    #page6 { display: flex; flex-direction: column; align-items: center; text-align: center; padding: 24px; background: rgba(0,0,0,0.6); border-radius: 12px; box-shadow: 0 0 16px rgba(0,0,0,0.8); height: 100vh; overflow-y: auto; }
    #page6 .logo { width: 80px; margin-bottom: 12px; }
    #page6 #finalPortrait img { width: 120px; height: 120px; object-fit: cover; border-radius: 50%; margin-bottom: 12px; }
    #page6 p { margin: 6px 0; }
    #page6 .badges { display: flex; gap: 24px; justify-content: center; margin: 16px 0; }
    @media(max-width:400px) { .btn{font-size:16px;padding:10px} .role img{max-width:80px;height:80px} }
  </style>
</head>
<body>
  <audio id="bgMusic" src="celtic-glory-307625.mp3" autoplay loop></audio>

  <!-- 1. Rejestracja -->
  <div id="page1" class="screen active">
    <h1>GRODOWA ODYSEJA</h1>
    <div class="instruction-box">
      <ul>
        <li>1. Wpisz nazwƒô dru≈ºyny ‚Üí <strong>DALEJ</strong></li>
        <li>2. Przeczytaj fabu≈Çƒô ‚Üí <strong>DALEJ</strong></li>
        <li>3. Wybierz postaƒá ‚Üí <strong>DALEJ</strong></li>
        <li>4. Obejrzyj filmik ‚Üí <strong>DALEJ</strong></li>
        <li>5. Wylosuj zadanie poboczne ‚Üí <strong>üé≤ LOSUJ</strong></li>
        <li>6. Po wykonaniu kliknij <strong>ZROBIONE</strong></li>
        <li>7. Wykonaj min. 4 zadania g≈Ç√≥wne</li>
        <li>8. Zatwierd≈∫ i resetuj b≈Çƒôdy üîÑ</li>
        <li>9. Kliknij <strong>PRZEJD≈π DO RADY</strong></li>
      </ul>
    </div>
    <input id="teamName" type="text" placeholder="Nazwa dru≈ºyny">
    <button id="next1" class="btn">DALEJ</button>
  </div>

  <!-- 2. Fabula -->
  <div id="page2" class="screen">
    <h2>Rok 972 ‚Äì Czas Pr√≥by</h2>
    <div class="instruction-box">
      <p>Rok 972.<br>
      M√≥wi siƒô, ≈ºe to bƒôdzie ostatni spokojny rok... [pe≈Çny opis fabu≈Çy tutaj w kolejnych paragrafach]</p>
    </div>
    <button id="next2" class="btn">DALEJ</button>
  </div>

  <!-- 3. Wyb√≥r postaci -->
  <div id="page3" class="screen">
    <h2>WYBIERZ POSTAƒÜ</h2>
    <div class="roles">
      <div class="role" data-role="zwiadowca"><img src="zwiadowca.1.png" alt="Zwiadowca"><p>Zwiadowca</p></div>
      <div class="role" data-role="tkaczka"><img src="tkaczka.1.png" alt="Tkaczka"><p>Tkaczka</p></div>
      <div class="role" data-role="zielarka"><img src="zielarka.1.png" alt="Zielarka"><p>Zielarka</p></div>
      <div class="role" data-role="kupiec"><img src="kupiec.1.png" alt="Kupiec"><p>Kupiec</p></div>
      <div class="role" data-role="rzemieslnik"><img src="rzemieslnik.1.png" alt="Rzemie≈õlnik"><p>Rzemie≈õlnik</p></div>
    </div>
    <button id="next3" class="btn" disabled>DALEJ</button>
  </div>

  <!-- 4. Filmik inicjacyjny -->
  <div id="videoOverlay">
    <video id="roleVideo" controls></video>
    <button id="videoNext" class="btn">DALEJ DO ZADA≈É</button>
  </div>

  <!-- 5. Zadania -->
  <div id="page4" class="screen">
    <h2>ZADANIA</h2>
    <div class="instruction-box">
      <p>Wykonuj samodzielnie ‚Äì nikt nic nie wpisuje.</p>
      <button id="randomBtn" class="btn">üé≤ Wylosuj zadanie</button>
      <p id="randomTask"></p>
      <button id="sideDone" class="btn" disabled>ZROBIONE</button>
    </div>
    <div id="taskStats">Uko≈Ñczono: <strong id="completedCount">0</strong>/6</div>
    <div id="tasksList">
      <div class="task-row" data-ans="LAMELKA"><span>Brama Grodziska</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="MIECH"><span>Warsztat Kowala</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="≈ªYTO"><span>Zagroda</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="LEN"><span>Chata Tkaczki</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="POKRZYWA"><span>Chata Zielarki</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
      <div class="task-row" data-ans="DIRHEMY"><span>Chata Namiestnika</span><input type="text"><button class="btn confirm">ZATWIERD≈π</button><button class="reset-icon">üîÑ</button></div>
    </div>
    <button id="toCouncil" class="btn" disabled>PRZEJD≈π DO RADY</button>
  </div>

  <!-- 6. Rada Grodu -->
  <div id="page5" class="screen">
    <h2>RADA GRODU</h2>
    <div class="roles">
      <div class="role"><button class="btn" data-dec="handel">üõí Otwarcie na handel</button></div>
      <div class="role"><button class="btn" data-dec="granice">üõ°Ô∏è Zamkniƒôcie granic</button></div>
      <div class="role"><button class="btn" data-dec="prawo">‚öñÔ∏è Wprowadzenie nowego prawa</button></div>
    </div>
  </div>

  <!-- 7. Gratulacje -->
  <div id="page6" class="screen">
    <img src="logo.1.png" class="logo" alt="Logo">
    <h1>GRATULACJE!</h1>
    <div id="finalPortrait"><img id="outPortrait" alt="Twoja postaƒá"></div>
    <p>Dru≈ºyna: <strong id="outTeam"></strong></p>
    <p>Postaƒá: <strong id="outRole"></strong></p>
    <p>Decyzja: <strong id="outDecisionName"></strong></p>
    <p id="outDecisionDesc"></p>
    <p>Zadanie poboczne: <strong id="outSideDone"></strong></p>
    <p>Uko≈Ñczono: <strong id="outPoints"></strong>/6</p>
    <div id="badges" class="badges"></div>
    <div id="downloads" style="text-align:center"></div>
    <button id="restart" class="btn">ZAGRAJ PONOWNIE</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const bg = document.getElementById('bgMusic');
      document.body.addEventListener('click', () => bg.play().catch(), { once: true });
      let team = '', role = '', completed = 0, sideDone = false;
      const vids = {
        zwiadowca: 'zwiadowca.1.mp4', tkaczka: 'tkaczka.1.mp4', zielarka: 'zielarka.1.mp4', kupiec: 'kupiec.1.mp4', rzemieslnik: 'rzemieslnik.1.mp4'
      };
      const sideTasks = [
        'Znajd≈∫ co≈õ zielonego i dotknij to.',
        'Zr√≥b 5 przysiad√≥w przy najbli≈ºszej ≈Çawce.',
        'Znajd≈∫ kamie≈Ñ wiƒôkszy ni≈º twoja d≈Ço≈Ñ.',
        'Zr√≥b zdjƒôcie czego≈õ okrƒÖg≈Çego.',
        'Znajd≈∫ co≈õ na literƒô P.',
        'Podskocz 3 razy w cieniu.',
        'U≈Ç√≥≈º literƒô A z patyk√≥w.',
        'Opisz kolor li≈õcia.',
        'Zr√≥b 10 krok√≥w do przodu, potem 5 w bok i znajd≈∫ co≈õ ciekawego.',
        'Sta≈Ñ na jednej nodze i policz do 10 na g≈Ços.'
      ];
      const endings = {
        handel: { name: 'Otwarcie na handel', desc: `Po dniach pe≈Çnych gorƒÖcych dyskusji, sprzecznych g≈Ços√≥w i narad pod gwiazdami, Rada Grodu podjƒô≈Ça decyzjƒô, kt√≥ra odmieni≈Ça losy krainy. Bramy zosta≈Çy otwarte, stra≈ºnicy powitali pierwsze karawany, a kurz z trakt√≥w przyni√≥s≈Ç zapachy nieznanych przypraw i szelest monet z odleg≈Çych kr√≥lestw. Targowiska rozb≈Çys≈Çy kolorami, a rzemie≈õlnicy zyskali dostƒôp do nowych surowc√≥w i technik.

Lecz z handlem przysz≈Çy te≈º cienie. Wie≈õci o znikajƒÖcych dobrach, szpiegach i dziwnych chorobach krƒÖ≈ºƒÖ po zau≈Çkach. Grodowi nie brak bogactwa ‚Äì lecz czy nie przyp≈Çaci go duszƒÖ?`},
        granice: { name: 'Zamkniƒôcie granic', desc: `Decyzja zapad≈Ça w ciszy, przerywanej jedynie trzaskiem pochodni i d≈∫wiƒôkiem zamykanych wr√≥t. Rada Grodu postawi≈Ça na bezpiecze≈Ñstwo. Stra≈ºe podwojono, mury wzmocniono, a szlaki pokry≈Ça trawa zapomnienia. Zapanowa≈Ç porzƒÖdek, ludzie ≈ºyjƒÖ w spokoju, karmiƒÖc siƒô plonami w≈Çasnych p√≥l i ufajƒÖc jedynie tym, kt√≥rych znajƒÖ od dziecka.

Jednak z ka≈ºdym dniem grodowe powietrze staje siƒô ciƒô≈ºsze. Zaczyna brakowaƒá inspiracji, wie≈õci ze ≈õwiata, nowo≈õci. Plotki o tajemniczych sylwetkach za murem, szeptane nocƒÖ, zaczynajƒÖ niepokoiƒá nawet najodwa≈ºniejszych. Zamkniƒôcie uratowa≈Ço Grodu cia≈Ço ‚Äì ale czy nie zgubiono jego ducha?`},
        prawo: { name: 'Wprowadzenie nowego prawa', desc: `G≈Ços Starszyzny ni√≥s≈Ç siƒô echem po sali, gdy og≈Çoszono narodziny nowego ≈Çadu. Dotychczasowe zasady ‚Äì stare jak same mury ‚Äì ustƒÖpi≈Çy miejsca ≈õwie≈ºym postanowieniom. Ustawa objƒô≈Ça ka≈ºdego: mo≈ºnych i prostych, ≈ºo≈Çnierzy i zielarki, kupc√≥w i bard√≥w. Jedni powitali jƒÖ z nadziejƒÖ, inni z trwogƒÖ.

Nowe prawo da≈Ço poczƒÖtek przemianom. Ale z ka≈ºdym paragrafem ros≈Ça te≈º pokusa ‚Äì nadu≈ºycia, spory interpretacyjne, walki o wp≈Çywy. Czy Grodowi uda siƒô zachowaƒá r√≥wnowagƒô miƒôdzy wolƒÖ ludu a potrzebƒÖ porzƒÖdku? A mo≈ºe reforma stanie siƒô iskrƒÖ wiƒôkszego ognia?`} 
      };
      function show(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active')); 
        document.getElementById(id).classList.add('active');
      }
      function updateStats() {
        document.getElementById('completedCount').innerText = completed;
        document.getElementById('toCouncil').disabled = completed < 4;
      }
      document.getElementById('next1').onclick = () => {
        const v = document.getElementById('teamName').value.trim();
        if (!v) return alert('Podaj nazwƒô dru≈ºyny');
        team = v;
        show('page2');
      };
      document.getElementById('next2').onclick = () => show('page3');
      document.querySelectorAll('#page3 .role').forEach(el => el.onclick = () => {
        document.querySelectorAll('#page3 .role').forEach(r => r.classList.remove('selected'));
        el.classList.add('selected');
        role = el.dataset.role;
        document.getElementById('next3').disabled = false;
      });
      document.getElementById('next3').onclick = () => {
        document.getElementById('roleVideo').src = vids[role];
        document.getElementById('videoOverlay').style.display = 'flex';
      };
      document.getElementById('videoNext').onclick = () => {
        sideDone = false; completed = 0; 
        updateStats();
        document.getElementById('videoOverlay').style.display = 'none';
        show('page4');
        document.getElementById('sideDone').disabled = false;
        document.getElementById('randomTask').innerText = '';
        document.querySelectorAll('.task-row').forEach(r => {r.classList.remove('correct','wrong'); r.querySelector('input').value = ''});
      };
      document.getElementById('randomBtn').onclick = () => document.getElementById('randomTask').innerText = sideTasks[Math.floor(Math.random()*sideTasks.length)];
      document.getElementById('sideDone').onclick = () => { sideDone = true; document.getElementById('sideDone').innerText = 'ZROBIONE'; };
      document.querySelectorAll('.task-row').forEach(row => {
        const ans = row.dataset.ans, inp = row.querySelector('input'), ok = row.querySelector('.confirm'), clr = row.querySelector('.reset-icon');
        ok.onclick = () => {
          const v = inp.value.trim().toUpperCase();
          if (v === ans) {
            if (!row.classList.contains('correct')) { row.classList.remove('wrong'); row.classList.add('correct'); completed++; }
          } else {
            if (row) { row.classList.remove('correct'); if (completed>0) completed--; }
            row.classList.add('wrong');
          }
          updateStats();
        };
        clr.onclick = () => {
          if (row.classList.contains('correct')) { row.classList.remove('correct'); completed--; }
          row.classList.remove('wrong'); inp.value = ''; updateStats();
        };
      });
      document.getElementById('toCouncil').onclick = () => show('page5');
      document.querySelectorAll('#page5 .btn[data-dec]').forEach(b => b.onclick = () => {
        const key = b.dataset.dec;
        document.getElementById('outTeam').innerText = team;
        document.getElementById('outRole').innerText = role;
        document.getElementById('outDecisionName').innerText = endings[key].name;
        document.getElementById('outDecisionDesc').innerText = endings[key].desc;
        document.getElementById('outPortrait').src = `${role}.png`;
        document.getElementById('outSideDone').innerText = sideDone ? 'TAK' : 'NIE';
        document.getElementById('outPoints').innerText = completed;
        document.getElementById('badges').innerHTML = sideDone
          ? `<img src="medalion.1.png" alt="Medalion"><img src="korona.1.png" alt="Korona">`
          : `<img src="medalion.1.png" alt="Medalion">`;
        document.getElementById('downloads').innerHTML = sideDone
          ? `<a href="medalion.1.png" download class="btn">POBIERZ MEDALION</a><a href="korona.1.png" download class="btn">POBIERZ KORONƒò</a>`
          : `<a href="medalion.1.png" download class="btn">POBIERZ MEDALION</a>`;
        show('page6');
      });
      document.getElementById('restart').onclick = () => location.reload();
    });
  </script>
</body>
</html>
