<!DOCTYPE html>
<html lang="pl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
  <title>Grodowa Odyseja</title>
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua&display=swap"
    rel="stylesheet"> <!-- Czcionki Å›redniowieczne -->
  <link rel="stylesheet" href="styles.css"> <!-- Dodano link do arkusza stylÃ³w -->
</head>

<body>
  <audio id="bgMusic" src="resources/mp3/celtic_festival.mp3" playsinline></audio>

  <!-- 1. Instrukcja gry -->
  <div id="page1" class="screen active">
    <h1>GRODOWA ODYSEJA</h1>
    <div class="instruction-box">
      <h3>Mechanika gry â€Dziedzictwoâ€</h3>
      <p>1. Wprowadzenie fabularne â€“ zapoznajcie siÄ™ z realiami Pomorza X wieku.</p>
      <p>2. Tworzenie druÅ¼yny â€“ wybierzcie nazwÄ™ druÅ¼yny, wprowadzajÄ…c jÄ… poniÅ¼ej.</p>
      <p>3. WybÃ³r postaci â€“ kaÅ¼da rola niesie unikalne moÅ¼liwoÅ›ci.</p>
      <p>4. Zadania â€“ wykonajcie 4 z 6 gÅ‚Ã³wnych zadaÅ„ oraz 1 zadanie poboczne.</p>
      <p>5. Rada Grodu â€“ wybierzcie decyzjÄ™, ktÃ³ra zadecyduje o losach grodu.</p>
    </div>
    <input id="teamName" type="text" placeholder="Nazwa druÅ¼yny">
    <button class="btn" id="to2">DALEJ</button>
  </div>

  <!-- 2. PeÅ‚na fabuÅ‚a -->
  <div id="page2" class="screen">
    <h2>PEÅNA FABUÅA</h2>
    <div class="instruction-box">
      <p>Rok 972. Sopockie Grodzisko pamiÄ™ta spokÃ³j ostatniego lata â€“ lecz teraz Ziemia drÅ¼y, jakby wyczuwaÅ‚a
        nadciÄ…gajÄ…ce przesilenie.</p>
      <p>Z poÅ‚udnia dobiegajÄ… echa zwyciÄ™stwa pod CedyniÄ…: ksiÄ…Å¼Ä™ Mieszko triumfuje, Hodon pada pod mieczem Czcibora, a
        cesarskie spojrzenie zwraca siÄ™ ku naszym granicom.</p>
      <p>Ze wschodu pÅ‚ynie nowa mowa â€“ twarde znaki Rusi, ktÃ³re Å‚Ä…czÄ… bizantyjskie krzyÅ¼e z pradawnymi baÅ‚tyckimi
        bÃ³stwami, niosÄ…c srebro i niepokÃ³j.</p>
      <p>Z zachodu zaÅ› unoszÄ… siÄ™ sÅ‚owa o chrzcie i kamiennych kaplicach: mÃ³wiÄ…, Å¼e DÄ…brÃ³wka przyniosÅ‚a pokÃ³j, lecz czy
        pokÃ³j wykuwany w Å¼elaznej wierze jest darem czy kajdanami?</p>
      <p>A wy â€“ tkacze, cieÅ›le, zwiadowcy, zielarki, kowale, handlarze â€“ strzeÅ¼ecie pamiÄ™Ä‡ przodkÃ³w: w popiele ognisk,
        pod korzeniami starych dÄ™bÃ³w, w runach wyrytych na kamieniu.</p>
      <ul>
        <li>â€“ Czy otworzyÄ‡ Grodzisko na obce mowy, bogÃ³w i prawo?</li>
        <li>â€“ Czy zamknÄ…Ä‡ bramy na sto lat, strzegÄ…c ognia, ktÃ³ry pÅ‚onÄ…Å‚ tutaj, zanim wybito pierwsze monety cesarskie?
        </li>
      </ul>
    </div>
    <button class="btn" id="to3">DALEJ</button>
  </div>

  <!-- 3. WybÃ³r postaci -->
  <div id="page3" class="screen">
    <h2>WYBIERZ POSTAÄ†</h2>
    <div class="roles">
      <div class="role" data-role="zwiadowca"><img src="resources/images/zwiadowca.png" alt="Zwiadowca">
        <p>Zwiadowca</p>
      </div>
      <div class="role" data-role="tkaczka"><img src="resources/images/tkaczka.png" alt="Tkaczka">
        <p>Tkaczka</p>
      </div>
      <div class="role" data-role="zielarka"><img src="resources/images/zielarka.png" alt="Zielarka">
        <p>Zielarka</p>
      </div>
      <div class="role" data-role="kupiec"><img src="resources/images/kupiec.png" alt="Kupiec">
        <p>Kupiec</p>
      </div>
      <div class="role" data-role="kowal"><img src="resources/images/kowal.png" alt="Kowal">
        <p>Kowal</p>
      </div>
    </div>
    <button class="btn" id="to4" disabled>DALEJ</button>
  </div>

  <!-- 4. Filmik inicjacyjny -->
  <div id="videoOverlay" class="screen"
    style="display:none;align-items:center;justify-content:center;flex-direction:column;">
    <video id="roleVideo" controls></video>
    <button class="btn" id="videoNext">DALEJ DO ZADAÅƒ</button>
  </div>

  <!-- 5. Interaktywne zadania -->
  <div id="page4" class="screen">
    <h2>INTERAKTYWNE ZADANIA</h2>
    <div class="instruction-box">
      <p>Wykonaj 4 gÅ‚Ã³wne zadania w lokacjach: Brama Grodziska, Warsztat Kowala, Chata Zielarki, Chata Tkaczki, Chata
        wodza oraz Targowisko. Wylosuj i zrealizuj 1 zadanie poboczne.</p>
    </div>
    <button class="btn" id="drawBtn">ğŸ² LOSUJ ZADANIE POBOCZNE</button>
    <p id="randomTask"></p>
    <button class="btn" id="sideBtn" disabled>ZREALIZOWANE</button>
    <button class="btn" id="toCouncil" disabled>PRZEJDÅ¹ DO RADY</button>
    <p>UkoÅ„czono: <span id="count">0</span>/6</p>
    <div id="tasksList">
      <div class="task-row" data-ans="LAMELKA"><span>Brama Grodziska</span><input type="text"><button
          class="btn confirm">ZATWIERDÅ¹</button><button class="reset-icon">ğŸ”„</button></div>
      <div class="task-row" data-ans="MIECH"><span>Warsztat Kowala</span><input type="text"><button
          class="btn confirm">ZATWIERDÅ¹</button><button class="reset-icon">ğŸ”„</button></div>
      <div class="task-row" data-ans="Å»YTO"><span>Targowisko</span><input type="text"><button
          class="btn confirm">ZATWIERDÅ¹</button><button class="reset-icon">ğŸ”„</button></div>
      <div class="task-row" data-ans="LEN"><span>Chata Tkaczki</span><input type="text"><button
          class="btn confirm">ZATWIERDÅ¹</button><button class="reset-icon">ğŸ”„</button></div>
      <div class="task-row" data-ans="POKRZYWA"><span>Chata Zielarki</span><input type="text"><button
          class="btn confirm">ZATWIERDÅ¹</button><button class="reset-icon">ğŸ”„</button></div>
      <div class="task-row" data-ans="DIRHEMY"><span>Chata wodza</span><input type="text"><button
          class="btn confirm">ZATWIERDÅ¹</button><button class="reset-icon">ğŸ”„</button></div>
    </div>
  </div>

  <!-- 6. Rada Grodu -->
  <div id="page5" class="screen">
    <h2>RADA GRODU â€“ DECYZYJNA KULMINACJA</h2>
    <button class="btn" id="endTrade">ğŸ›’ Otwarcie na handel</button>
    <button class="btn" id="endClose">ğŸ›¡ï¸ ZamkniÄ™cie granic</button>
    <button class="btn" id="endLaw">âš–ï¸ Wprowadzenie nowego prawa</button>
  </div>

  <!-- 7. Podsumowanie rozgrywki -->
  <div id="page6" class="screen">
    <img src="resources/images/logo.png" class="museum-logo" alt="Muzeum">
    <h1>GRATULACJE!</h1>
    <div id="finalPortrait"><img id="avatar" alt="Twoja postaÄ‡"></div>
    <div class="final-box">
      <p><strong>DruÅ¼yna:</strong> <span id="resTeam"></span></p>
      <p><strong>PostaÄ‡:</strong> <span id="resRole"></span></p>
      <p><strong>Zadania gÅ‚Ã³wne:</strong> <span id="resCount"></span>/6</p>
      <p><strong>Zadanie poboczne:</strong> <span id="resSide"></span></p>
      <p><strong>Decyzja Rady:</strong> <span id="resDec"></span></p>
      <p id="resDesc" style="white-space:pre-wrap;margin-top:8px"></p>
      <div class="badges"></div>
      <div class="downloads"></div>
      <p class="note">ğŸ… NaklejkÄ™ korony otrzymuje ten, kto wykonaÅ‚ zadanie losowe.</p>
    </div>
    <button class="btn" id="restartBtn">ZAGRAJ PONOWNIE</button>
  </div>

  <script>
    const musicTracks = [
    'resources/mp3/celtic_dance.mp3',
    'resources/mp3/celtic_festival.mp3',
    'resources/mp3/celtic_legends.mp3',
    'resources/mp3/celtic_morning.mp3'
  ];
  let currentTrack = 0;
  const bgMusic = document.getElementById('bgMusic');

  function playTrack(idx) {
    bgMusic.src = musicTracks[idx];
    bgMusic.play().catch(() => {});
  }

  function startBackgroundMusic() {
    playTrack(currentTrack);
  }

  bgMusic.addEventListener('ended', () => {
    currentTrack = (currentTrack + 1) % musicTracks.length;
    playTrack(currentTrack);
  });

  window.addEventListener('DOMContentLoaded', startBackgroundMusic);

  let team = '', role = '', count = 0, sideDone = false;
  const vids = { zwiadowca: 'resources/mp4/zwiadowca.mp4', tkaczka: 'resources/mp4/tkaczka.mp4', zielarka: 'resources/mp4/zielarka.mp4', kupiec: 'resources/mp4/kupiec.mp4', kowal: 'resources/mp4/kowal.mp4' };
  const avatars = { zwiadowca: 'resources/images/zwiadowca.png', tkaczka: 'resources/images/tkaczka.png', zielarka: 'resources/images/zielarka.png', kupiec: 'resources/images/kupiec.png', kowal: 'resources/images/kowal.png' };
  const sideTasks = [
    'ZnajdÅº coÅ› zielonego i dotknij to.',
    'ZrÃ³b 5 przysiadÃ³w przy Å‚awce.',
    'ZnajdÅº kamieÅ„ wiÄ™kszy niÅ¼ dÅ‚oÅ„.',
    'ZrÃ³b zdjÄ™cie czegoÅ› okrÄ…gÅ‚ego.',
    'ZnajdÅº coÅ› na literÄ™ P.',
    'Podskocz 3 razy w cieniu.',
    'UÅ‚Ã³Å¼ literÄ™ A z patykÃ³w.',
    'Opisz kolor liÅ›cia.',
    'ZrÃ³b 10 krokÃ³w do przodu i 5 w bok.',
    'StaÅ„ na jednej nodze i licz do 10 na gÅ‚os.'
  ];
  const endings = {
    handel: { name: 'Otwarcie na handel', desc: 'Po dniach peÅ‚nych gorÄ…cych dyskusji, sprzecznych gÅ‚osÃ³w i narad pod gwiazdami, Rada Grodu wyÅ‚oniÅ‚a nowe moÅ¼liwoÅ›ci wymiany. Bramy otwarto, kupcy przybyli z odlegÅ‚ych krain, a w powietrzu unosiÅ‚ siÄ™ zapach przypraw i dÅºwiÄ™k monet. RzemieÅ›lnicy poszerzyli horyzonty, ale rÃ³wnoczeÅ›nie wzrosÅ‚o ryzyko chorÃ³b i oszustw. Grodzisko staÅ‚o siÄ™ prÄ™Å¼nym oÅ›rodkiem handlu - czy zyskaÅ‚o dziÄ™ki temu swe prawdziwe dziedzictwo?' },
    granice: { name: 'ZamkniÄ™cie granic', desc: 'W obawie przed nieznanym Rada podjÄ™Å‚a decyzjÄ™ o zamkniÄ™ciu murÃ³w. StraÅ¼e wzmocniono, handel ograniczono, a mieszkaÅ„cy zwrÃ³cili siÄ™ ku wÅ‚asnym plonom. SpokÃ³j zapanowaÅ‚, ale wraz z nim narastaÅ‚a izolacja. Ciche szeptania o bogactwach poza murami pobudzaÅ‚y tÄ™sknotÄ™. Czy bezpieczeÅ„stwo usprawiedliwiÅ‚o utratÄ™ wolnoÅ›ci ducha?' },
    prawo: { name: 'Wprowadzenie nowego prawa', desc: 'Pod przewodnictwem starszyzny wprowadzono Å›wieÅ¼e ustawy. KaÅ¼dy â€“ moÅ¼ny i prosty â€“ musiaÅ‚ podporzÄ…dkowaÄ‡ siÄ™ nowym paragrafom. Spory szybko narosÅ‚y, gdy reguÅ‚y interpretowano na rÃ³Å¼ne sposoby. Nowe prawo obiecaÅ‚o porzÄ…dek, ale takÅ¼e rozpoczÄ™Å‚o walkÄ™ o wpÅ‚ywy i odsÅ‚oniÅ‚o pÄ™kniÄ™cia w jednoÅ›ci wspÃ³lnoty. Czy Ã³w Å‚ad zdoÅ‚aÅ‚ przetrwaÄ‡ burze ambicji?' }
  };

  function show(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }

  document.getElementById('to2').addEventListener('click', () => {
    const input = document.getElementById('teamName');
    if (!input.value.trim()) alert('Podaj nazwÄ™ druÅ¼yny');
    else { team = input.value.trim(); show('page2'); startBackgroundMusic(); }
  });

  document.getElementById('to3').addEventListener('click', () => show('page3'));

  document.querySelectorAll('.role').forEach(el => el.addEventListener('click', () => {
    role = el.dataset.role;
    document.querySelectorAll('.role').forEach(r => r.classList.toggle('selected', r === el));
    document.getElementById('to4').disabled = false;
  }));

  document.getElementById('to4').addEventListener('click', () => {
    document.getElementById('roleVideo').src = vids[role];
    document.getElementById('videoOverlay').style.display = 'flex';
  });

  document.getElementById('videoNext').addEventListener('click', () => {
    document.getElementById('videoOverlay').style.display = 'none';
    show('page4');
  });

  function updateStats() {
    document.getElementById('count').innerText = count;
    document.getElementById('toCouncil').disabled = count < 4;
  }

  document.querySelectorAll('.confirm').forEach(btn => btn.addEventListener('click', () => {
    const row = btn.closest('.task-row');
    const answer = row.dataset.ans;
    const user = row.querySelector('input').value.trim().toUpperCase();
    if (user === answer) {
      if (!row.classList.contains('correct')) { row.classList.remove('wrong'); row.classList.add('correct'); count++; }
    } else {
      if (row.classList.contains('correct')) { row.classList.remove('correct'); count--; }
      row.classList.add('wrong');
    }
    updateStats();
  }));

  document.querySelectorAll('.reset-icon').forEach(btn => btn.addEventListener('click', () => {
    const row = btn.closest('.task-row');
    if (row.classList.contains('correct')) { row.classList.remove('correct'); count--; }
    row.classList.remove('wrong');
    row.querySelector('input').value = '';
    updateStats();
  }));

  document.getElementById('drawBtn').addEventListener('click', () => {
    document.getElementById('randomTask').innerText = sideTasks[Math.floor(Math.random() * sideTasks.length)];
    document.getElementById('sideBtn').disabled = false;
  });

  document.getElementById('sideBtn').addEventListener('click', () => {
    sideDone = true;
    document.getElementById('sideBtn').style.background = 'lime';
  });

  document.getElementById('toCouncil').addEventListener('click', () => show('page5'));

  document.getElementById('endTrade').addEventListener('click', () => finish('handel'));
  document.getElementById('endClose').addEventListener('click', () => finish('granice'));
  document.getElementById('endLaw').addEventListener('click', () => finish('prawo'));

  function finish(dec) {
    document.getElementById('resTeam').innerText = team;
    document.getElementById('resRole').innerText = role;
    document.getElementById('resCount').innerText = count;
    document.getElementById('resSide').innerText = sideDone ? 'TAK' : 'NIE';
    document.getElementById('resDec').innerText = endings[dec].name;
    document.getElementById('resDesc').innerText = endings[dec].desc;
    document.getElementById('avatar').src = avatars[role];
    document.querySelector('.badges').innerHTML = '<img src="resources/images/medalion.png" alt="Medalion">' + (sideDone ? '<img src="resources/images/korona.png" alt="Korona">' : '');
    document.querySelector('.downloads').innerHTML = '<a href="resources/images/medalion.png" download class="btn">POBIERZ MEDALION</a>' + (sideDone ? '<a href="resources/images/korona.png" download class="btn">POBIERZ KORONÄ˜</a>' : '');
    show('page6');
  }

  document.getElementById('restartBtn').addEventListener('click', () => {
    team = ''; role = ''; count = 0; sideDone = false;
    document.getElementById('teamName').value = '';
    document.querySelectorAll('.task-row').forEach(r => r.classList.remove('correct', 'wrong'));
    document.querySelectorAll('#tasksList input').forEach(i => i.value = '');
    document.getElementById('randomTask').innerText = '';
    document.getElementById('sideBtn').disabled = true;
    document.getElementById('sideBtn').style.background = '';
    document.querySelectorAll('.role').forEach(r => r.classList.remove('selected'));
    document.getElementById('to4').disabled = true;
    document.getElementById('toCouncil').disabled = true;
    updateStats();
    show('page1');
  });
  </script>
</body>
</html>